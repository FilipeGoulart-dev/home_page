<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard do Filipe</title>
    <meta name="description" content="Dashboard pessoal do Filipe">
    <meta name="theme-color" content="#1e1b4b">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸš€</text></svg>">
    
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --accent-primary: #22d3ee;
            --accent-secondary: #06b6d4;
        }

        * {
            font-family: 'Inter', sans-serif;
        }
        
        .title-font {
            font-family: 'Space Grotesk', sans-serif;
        }

        /* ===== LIGHT THEME ===== */
        .light-theme {
            color: #1f2937;
        }

        .light-theme .glass-dark {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #1f2937;
        }

        .light-theme .glass {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .light-theme .parallax-overlay {
            background: rgba(255, 255, 255, 0.3);
        }

        .light-theme .text-white {
            color: #1f2937;
        }

        .light-theme .text-white\/80 {
            color: rgba(31, 41, 55, 0.8);
        }

        .light-theme .text-white\/70 {
            color: rgba(31, 41, 55, 0.7);
        }

        .light-theme .text-white\/60 {
            color: rgba(31, 41, 55, 0.6);
        }

        .light-theme .text-white\/50 {
            color: rgba(31, 41, 55, 0.5);
        }

        .light-theme .text-white\/40 {
            color: rgba(31, 41, 55, 0.4);
        }

        .light-theme .bg-white\/10 {
            background: rgba(0, 0, 0, 0.05);
        }

        .light-theme .bg-white\/20 {
            background: rgba(0, 0, 0, 0.1);
        }

        .light-theme .hover\:bg-white\/30:hover {
            background: rgba(0, 0, 0, 0.15);
        }

        .light-theme .border-white\/20 {
            border-color: rgba(0, 0, 0, 0.1);
        }

        .light-theme .border-white\/10 {
            border-color: rgba(0, 0, 0, 0.05);
        }

        .light-theme input,
        .light-theme select,
        .light-theme textarea {
            color: #1f2937;
        }

        .light-theme input::placeholder {
            color: rgba(31, 41, 55, 0.5);
        }

        .light-theme ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }

        .light-theme ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
        }

        .light-theme .kanban-column {
            background: rgba(0, 0, 0, 0.03);
        }

        .light-theme .toast {
            background: rgba(255, 255, 255, 0.95);
            color: #1f2937;
        }

        .light-theme .confirm-modal-content {
            background: rgba(255, 255, 255, 0.95);
            color: #1f2937;
        }

        /* Accent color application */
        .accent-text {
            color: var(--accent-primary);
        }

        .accent-bg {
            background: var(--accent-primary);
        }

        .accent-border {
            border-color: var(--accent-primary);
        }

        .accent-gradient {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
        }

        /* ===== JARVIS SPLASH SCREEN ===== */
        .splash-screen {
            position: fixed;
            inset: 0;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: radial-gradient(ellipse at center, #0a1628 0%, #020817 50%, #000000 100%);
            transition: opacity 1.2s ease, visibility 1.2s ease;
            overflow: hidden;
        }

        .splash-screen.fade-out {
            opacity: 0;
            visibility: hidden;
        }

        /* Jarvis Background Grid */
        .jarvis-grid {
            position: absolute;
            inset: 0;
            background-image: 
                linear-gradient(rgba(6, 182, 212, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridPulse 4s ease-in-out infinite;
        }

        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        /* Floating Particles */
        .jarvis-particles {
            position: absolute;
            inset: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #22d3ee;
            border-radius: 50%;
            box-shadow: 0 0 10px #22d3ee, 0 0 20px #22d3ee;
            animation: particleFloat 8s linear infinite;
        }

        .particle:nth-child(1) { left: 10%; animation-delay: 0s; animation-duration: 12s; }
        .particle:nth-child(2) { left: 20%; animation-delay: 1s; animation-duration: 10s; }
        .particle:nth-child(3) { left: 30%; animation-delay: 2s; animation-duration: 14s; }
        .particle:nth-child(4) { left: 40%; animation-delay: 0.5s; animation-duration: 11s; }
        .particle:nth-child(5) { left: 50%; animation-delay: 1.5s; animation-duration: 13s; }
        .particle:nth-child(6) { left: 60%; animation-delay: 2.5s; animation-duration: 9s; }
        .particle:nth-child(7) { left: 70%; animation-delay: 0.8s; animation-duration: 15s; }
        .particle:nth-child(8) { left: 80%; animation-delay: 1.8s; animation-duration: 10s; }
        .particle:nth-child(9) { left: 90%; animation-delay: 3s; animation-duration: 12s; }
        .particle:nth-child(10) { left: 15%; animation-delay: 0.3s; animation-duration: 11s; }
        .particle:nth-child(11) { left: 35%; animation-delay: 1.2s; animation-duration: 13s; }
        .particle:nth-child(12) { left: 55%; animation-delay: 2.2s; animation-duration: 14s; }
        .particle:nth-child(13) { left: 75%; animation-delay: 0.7s; animation-duration: 10s; }
        .particle:nth-child(14) { left: 85%; animation-delay: 1.7s; animation-duration: 12s; }
        .particle:nth-child(15) { left: 25%; animation-delay: 2.8s; animation-duration: 15s; }

        @keyframes particleFloat {
            0% { 
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translateY(90vh) scale(1);
            }
            90% {
                opacity: 1;
            }
            100% { 
                transform: translateY(-10vh) scale(0);
                opacity: 0;
            }
        }

        /* Central Hologram Container */
        .jarvis-hologram {
            position: relative;
            width: 350px;
            height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Rotating Circles */
        .jarvis-circle {
            position: absolute;
            border-radius: 50%;
            border: 2px solid transparent;
        }

        .jarvis-circle-1 {
            width: 100%;
            height: 100%;
            border-color: rgba(6, 182, 212, 0.3);
            border-top-color: #22d3ee;
            border-right-color: #22d3ee;
            animation: rotate 4s linear infinite;
            box-shadow: 0 0 30px rgba(34, 211, 238, 0.2), inset 0 0 30px rgba(34, 211, 238, 0.1);
        }

        .jarvis-circle-2 {
            width: 85%;
            height: 85%;
            border-color: rgba(59, 130, 246, 0.3);
            border-bottom-color: #3b82f6;
            border-left-color: #3b82f6;
            animation: rotateReverse 3s linear infinite;
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.2), inset 0 0 25px rgba(59, 130, 246, 0.1);
        }

        .jarvis-circle-3 {
            width: 70%;
            height: 70%;
            border-color: rgba(168, 85, 247, 0.3);
            border-top-color: #a855f7;
            animation: rotate 5s linear infinite;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.2), inset 0 0 20px rgba(168, 85, 247, 0.1);
        }

        .jarvis-circle-4 {
            width: 55%;
            height: 55%;
            border-color: rgba(6, 182, 212, 0.4);
            border-right-color: #22d3ee;
            border-bottom-color: #22d3ee;
            animation: rotateReverse 2.5s linear infinite;
        }

        .jarvis-circle-5 {
            width: 40%;
            height: 40%;
            border-width: 3px;
            border-color: rgba(34, 211, 238, 0.6);
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 0 40px rgba(34, 211, 238, 0.4), inset 0 0 40px rgba(34, 211, 238, 0.2);
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes rotateReverse {
            from { transform: rotate(360deg); }
            to { transform: rotate(0deg); }
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                opacity: 0.8;
            }
            50% { 
                transform: scale(1.1);
                opacity: 1;
            }
        }

        /* Arc Segments */
        .jarvis-arc {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .jarvis-arc::before,
        .jarvis-arc::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px solid transparent;
        }

        .jarvis-arc-1::before {
            border-top-color: #22d3ee;
            animation: arcRotate1 3s ease-in-out infinite;
        }

        .jarvis-arc-2::after {
            border-bottom-color: #3b82f6;
            animation: arcRotate2 4s ease-in-out infinite;
        }

        @keyframes arcRotate1 {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes arcRotate2 {
            0% { transform: rotate(180deg); }
            50% { transform: rotate(360deg); }
            100% { transform: rotate(540deg); }
        }

        /* Scan Line */
        .jarvis-scan {
            position: absolute;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #22d3ee, transparent);
            top: 50%;
            left: 50%;
            transform-origin: left center;
            animation: scan 3s linear infinite;
            box-shadow: 0 0 20px #22d3ee;
        }

        @keyframes scan {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Data Points */
        .jarvis-data-points {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .data-point {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #22d3ee;
            border-radius: 50%;
            box-shadow: 0 0 15px #22d3ee, 0 0 30px #22d3ee;
        }

        .data-point::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 1px solid rgba(34, 211, 238, 0.5);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: dataPointPulse 2s ease-out infinite;
        }

        @keyframes dataPointPulse {
            0% { 
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translate(-50%, -50%) scale(3);
                opacity: 0;
            }
        }

        .data-point:nth-child(1) { top: 5%; left: 50%; transform: translateX(-50%); animation: dataFloat 3s ease-in-out infinite; }
        .data-point:nth-child(2) { top: 50%; right: 5%; transform: translateY(-50%); animation: dataFloat 3s ease-in-out infinite 0.5s; }
        .data-point:nth-child(3) { bottom: 5%; left: 50%; transform: translateX(-50%); animation: dataFloat 3s ease-in-out infinite 1s; }
        .data-point:nth-child(4) { top: 50%; left: 5%; transform: translateY(-50%); animation: dataFloat 3s ease-in-out infinite 1.5s; }
        .data-point:nth-child(5) { top: 15%; left: 15%; animation: dataFloat 3s ease-in-out infinite 0.3s; }
        .data-point:nth-child(6) { top: 15%; right: 15%; animation: dataFloat 3s ease-in-out infinite 0.8s; }
        .data-point:nth-child(7) { bottom: 15%; right: 15%; animation: dataFloat 3s ease-in-out infinite 1.3s; }
        .data-point:nth-child(8) { bottom: 15%; left: 15%; animation: dataFloat 3s ease-in-out infinite 1.8s; }

        @keyframes dataFloat {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Connection Lines */
        .jarvis-connections {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .connection-line {
            position: absolute;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(34, 211, 238, 0.5), transparent);
            transform-origin: center;
            animation: linePulse 2s ease-in-out infinite;
        }

        .connection-line:nth-child(1) { width: 40%; top: 50%; left: 5%; animation-delay: 0s; }
        .connection-line:nth-child(2) { width: 40%; top: 50%; right: 5%; animation-delay: 0.3s; }
        .connection-line:nth-child(3) { width: 100%; top: 25%; left: 0; animation-delay: 0.6s; }
        .connection-line:nth-child(4) { width: 100%; top: 75%; left: 0; animation-delay: 0.9s; }

        @keyframes linePulse {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.8; }
        }

        /* HUD Corners */
        .hud-corner {
            position: absolute;
            width: 40px;
            height: 40px;
            border-color: #22d3ee;
            border-style: solid;
            border-width: 0;
            opacity: 0.7;
        }

        .hud-corner-tl { top: 0; left: 0; border-top-width: 3px; border-left-width: 3px; }
        .hud-corner-tr { top: 0; right: 0; border-top-width: 3px; border-right-width: 3px; }
        .hud-corner-bl { bottom: 0; left: 0; border-bottom-width: 3px; border-left-width: 3px; }
        .hud-corner-br { bottom: 0; right: 0; border-bottom-width: 3px; border-right-width: 3px; }

        /* Text Content */
        .jarvis-content {
            position: relative;
            z-index: 10;
            text-align: center;
        }

        .splash-greeting {
            font-size: 1.2rem;
            color: #22d3ee;
            margin-bottom: 0.5rem;
            opacity: 0;
            transform: translateY(20px);
            animation: jarvisTextIn 0.8s ease forwards 0.5s;
            text-shadow: 0 0 20px rgba(34, 211, 238, 0.8);
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        .splash-name {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, #22d3ee 0%, #3b82f6 50%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 0;
            transform: scale(0.5);
            animation: jarvisNameIn 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.8s;
            filter: drop-shadow(0 0 30px rgba(34, 211, 238, 0.5));
        }

        .splash-tagline {
            font-size: 0.9rem;
            color: rgba(34, 211, 238, 0.7);
            margin-top: 1rem;
            opacity: 0;
            animation: jarvisTextIn 0.8s ease forwards 1.5s;
            letter-spacing: 2px;
        }

        @keyframes jarvisTextIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes jarvisNameIn {
            0% {
                opacity: 0;
                transform: scale(0.5);
                filter: drop-shadow(0 0 0px rgba(34, 211, 238, 0));
            }
            50% {
                filter: drop-shadow(0 0 60px rgba(34, 211, 238, 0.8));
            }
            100% {
                opacity: 1;
                transform: scale(1);
                filter: drop-shadow(0 0 30px rgba(34, 211, 238, 0.5));
            }
        }

        /* Loading Bar */
        .jarvis-loader {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            opacity: 0;
            animation: jarvisTextIn 0.5s ease forwards 2s;
        }

        .loader-bar {
            height: 4px;
            background: rgba(34, 211, 238, 0.2);
            border-radius: 2px;
            overflow: hidden;
            border: 1px solid rgba(34, 211, 238, 0.3);
        }

        .loader-progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #22d3ee, #3b82f6, #a855f7);
            border-radius: 2px;
            animation: loaderProgress 2s ease-out forwards 2.2s;
            box-shadow: 0 0 20px #22d3ee;
        }

        @keyframes loaderProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        .loader-text {
            text-align: center;
            margin-top: 10px;
            font-size: 0.75rem;
            color: rgba(34, 211, 238, 0.7);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .loader-percentage {
            font-family: 'Space Grotesk', monospace;
            font-size: 0.85rem;
            color: #22d3ee;
        }

        /* Status Indicators */
        .jarvis-status {
            position: absolute;
            bottom: 150px;
            display: flex;
            gap: 30px;
            opacity: 0;
            animation: jarvisTextIn 0.5s ease forwards 1.8s;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.7rem;
            color: rgba(34, 211, 238, 0.7);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            animation: statusBlink 1.5s ease-in-out infinite;
            box-shadow: 0 0 10px #22c55e;
        }

        .status-dot.loading {
            background: #eab308;
            box-shadow: 0 0 10px #eab308;
        }

        @keyframes statusBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* Hexagon Background Pattern */
        .hexagon-pattern {
            position: absolute;
            inset: 0;
            opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%2322d3ee' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes nameReveal {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(250%); }
            100% { transform: translateX(-100%); }
        }

        /* Parallax Background */
        body {
            transition: background 1s ease-in-out;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .parallax-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: -2;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            transform: translateZ(0);
            will-change: transform;
        }

        /* Garantir cobertura total mesmo com scroll */
        .parallax-bg::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 200%;
            background: inherit;
            background-size: cover;
            background-position: center;
        }

        .parallax-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: -1;
            background: rgba(0,0,0,0.4);
        }

        /* Page Enter Animation */
        .main-content {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .main-content.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .glass-dark {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Post-it Styles */
        .post-it {
            transform: rotate(var(--rotation));
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
            cursor: grab;
        }

        .post-it:hover {
            transform: rotate(0deg) scale(1.05);
            z-index: 100;
            box-shadow: 10px 10px 25px rgba(0,0,0,0.4);
        }

        .post-it.dragging {
            cursor: grabbing;
            transform: rotate(0deg) scale(1.1);
            z-index: 1000;
            box-shadow: 15px 15px 35px rgba(0,0,0,0.5);
        }

        .post-it-yellow { background: linear-gradient(135deg, #fef08a 0%, #fde047 100%); }
        .post-it-pink { background: linear-gradient(135deg, #fbcfe8 0%, #f9a8d4 100%); }
        .post-it-blue { background: linear-gradient(135deg, #bae6fd 0%, #7dd3fc 100%); }
        .post-it-green { background: linear-gradient(135deg, #bbf7d0 0%, #86efac 100%); }
        .post-it-orange { background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%); }
        .post-it-purple { background: linear-gradient(135deg, #e9d5ff 0%, #d8b4fe 100%); }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(var(--rotation)); }
            50% { transform: translateY(-5px) rotate(var(--rotation)); }
        }

        .post-it.floating {
            animation: float 3s ease-in-out infinite;
        }

        .post-it:hover {
            animation: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8) rotate(var(--rotation)); }
            to { opacity: 1; transform: scale(1) rotate(var(--rotation)); }
        }

        .post-it-new {
            animation: fadeIn 0.4s ease-out;
        }

        /* Priority Indicators */
        .priority-high { border-left: 4px solid #ef4444 !important; }
        .priority-medium { border-left: 4px solid #f59e0b !important; }
        .priority-low { border-left: 4px solid #22c55e !important; }

        /* Due Date Warning */
        .due-soon {
            animation: duePulse 2s ease-in-out infinite;
        }

        @keyframes duePulse {
            0%, 100% { box-shadow: 5px 5px 15px rgba(0,0,0,0.3); }
            50% { box-shadow: 5px 5px 15px rgba(239, 68, 68, 0.5), 0 0 20px rgba(239, 68, 68, 0.3); }
        }

        .overdue {
            border: 2px solid #ef4444 !important;
        }

        /* Category Tag */
        .category-tag {
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 10px;
            background: rgba(0,0,0,0.15);
        }

        .pomodoro-progress {
            transition: stroke-dashoffset 1s linear;
        }

        /* Link Styles */
        .link-item {
            transition: all 0.2s ease;
            cursor: grab;
        }

        .link-item:hover {
            transform: translateY(-3px);
        }

        .link-item.dragging {
            cursor: grabbing;
            opacity: 0.8;
            transform: scale(1.1);
        }

        .link-folder {
            background: rgba(255,255,255,0.05);
            border: 1px dashed rgba(255,255,255,0.2);
        }

        .search-bar {
            transition: all 0.3s ease;
        }

        .search-bar:focus-within {
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(255,255,255,0.2);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
        }

        /* Quote Animation */
        .quote-fade {
            animation: quoteFade 0.5s ease;
        }

        @keyframes quoteFade {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== REALISTIC WEATHER ICONS ===== */
        .weather-icon {
            width: 80px;
            height: 80px;
            position: relative;
            margin: 0 auto;
        }

        /* === REALISTIC SUN === */
        .weather-sun {
            position: absolute;
            width: 44px;
            height: 44px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .weather-sun::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, #fcd34d 0%, #f59e0b 60%, #d97706 100%);
            border-radius: 50%;
            box-shadow: 0 0 20px #fcd34d, 0 0 40px rgba(251, 191, 36, 0.5), 0 0 60px rgba(245, 158, 11, 0.3);
            animation: sunPulse 3s ease-in-out infinite;
        }

        /* Sun rays */
        .weather-sun .sun-rays {
            position: absolute;
            width: 70px;
            height: 70px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: sunRaysRotate 20s linear infinite;
        }

        .weather-sun .sun-rays::before,
        .weather-sun .sun-rays::after {
            content: '';
            position: absolute;
            background: linear-gradient(to bottom, #fcd34d, transparent);
            width: 4px;
            height: 12px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }

        .weather-sun .sun-rays::before {
            top: 0;
            box-shadow: 
                0 58px 0 #fcd34d,
                -29px 29px 0 #fcd34d,
                29px 29px 0 #fcd34d,
                -33px 0 0 #fcd34d,
                33px 0 0 #fcd34d,
                -29px -29px 0 #fcd34d,
                29px -29px 0 #fcd34d;
        }

        .weather-sun .sun-core {
            position: absolute;
            width: 24px;
            height: 24px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, #fef3c7 0%, #fcd34d 100%);
            border-radius: 50%;
            animation: sunCoreGlow 2s ease-in-out infinite;
        }

        @keyframes sunPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px #fcd34d, 0 0 40px rgba(251, 191, 36, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 30px #fcd34d, 0 0 60px rgba(251, 191, 36, 0.6); }
        }

        @keyframes sunRaysRotate {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        @keyframes sunCoreGlow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        /* === REALISTIC CLOUD === */
        .weather-cloud {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 55px;
            height: 28px;
        }

        .weather-cloud::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            border-radius: 28px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), inset 0 -3px 10px rgba(0, 0, 0, 0.1);
            animation: cloudFloat 4s ease-in-out infinite;
        }

        .weather-cloud::after {
            content: '';
            position: absolute;
            width: 26px;
            height: 26px;
            background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 50%;
            top: -14px;
            left: 10px;
            box-shadow: 
                22px 6px 0 4px #e2e8f0,
                22px 6px 0 4px #f1f5f9,
                0 3px 10px rgba(0, 0, 0, 0.15);
        }

        .weather-cloud .cloud-scan {
            display: none;
        }

        @keyframes cloudFloat {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(3px); }
        }

        /* === REALISTIC PARTLY CLOUDY === */
        .weather-partly-cloudy .weather-sun {
            width: 32px;
            height: 32px;
            top: 25%;
            left: 25%;
            transform: translate(-50%, -50%);
        }

        .weather-partly-cloudy .weather-sun .sun-rays {
            width: 50px;
            height: 50px;
        }

        .weather-partly-cloudy .weather-sun .sun-core {
            width: 16px;
            height: 16px;
        }

        .weather-partly-cloudy .weather-cloud {
            top: 60%;
            left: 60%;
            width: 48px;
            height: 24px;
            z-index: 2;
        }

        .weather-partly-cloudy .weather-cloud::after {
            width: 22px;
            height: 22px;
            top: -12px;
            left: 8px;
        }

        /* === REALISTIC CLOUDY === */
        .weather-cloudy .weather-cloud {
            z-index: 2;
        }

        .weather-cloudy .cloud-back {
            position: absolute;
            width: 42px;
            height: 22px;
            top: 20%;
            left: 20%;
            background: linear-gradient(180deg, #94a3b8 0%, #64748b 100%);
            border-radius: 22px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            animation: cloudFloatBack 5s ease-in-out infinite;
        }

        .weather-cloudy .cloud-back::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            background: linear-gradient(180deg, #94a3b8 0%, #64748b 100%);
            border-radius: 50%;
            top: -10px;
            left: 10px;
            box-shadow: 16px 4px 0 2px #94a3b8;
        }

        @keyframes cloudFloatBack {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(-4px); }
        }

        /* === REALISTIC RAIN === */
        .weather-rain .weather-cloud {
            top: 25%;
        }

        .weather-rain .weather-cloud::before {
            background: linear-gradient(180deg, #94a3b8 0%, #64748b 50%, #475569 100%);
        }

        .weather-rain .weather-cloud::after {
            background: linear-gradient(180deg, #94a3b8 0%, #64748b 100%);
            box-shadow: 22px 6px 0 4px #64748b;
        }

        .weather-rain .rain-drops {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 40px;
        }

        .weather-rain .drop {
            position: absolute;
            width: 3px;
            height: 14px;
            background: linear-gradient(180deg, transparent 0%, #60a5fa 30%, #3b82f6 100%);
            border-radius: 0 0 3px 3px;
            animation: rainFall 0.7s linear infinite;
        }

        .weather-rain .drop:nth-child(1) { left: 6px; animation-delay: 0s; }
        .weather-rain .drop:nth-child(2) { left: 14px; animation-delay: 0.2s; }
        .weather-rain .drop:nth-child(3) { left: 22px; animation-delay: 0.1s; }
        .weather-rain .drop:nth-child(4) { left: 30px; animation-delay: 0.35s; }
        .weather-rain .drop:nth-child(5) { left: 38px; animation-delay: 0.15s; }
        .weather-rain .drop:nth-child(6) { left: 10px; animation-delay: 0.45s; }

        @keyframes rainFall {
            0% { transform: translateY(-5px); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translateY(35px); opacity: 0; }
        }

        /* === REALISTIC STORM === */
        .weather-storm .weather-cloud {
            top: 20%;
        }

        .weather-storm .weather-cloud::before {
            background: linear-gradient(180deg, #64748b 0%, #475569 50%, #334155 100%);
        }

        .weather-storm .weather-cloud::after {
            background: linear-gradient(180deg, #64748b 0%, #475569 100%);
            box-shadow: 22px 6px 0 4px #475569;
        }

        .weather-storm .lightning {
            position: absolute;
            top: 42%;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 35px;
            z-index: 3;
        }

        .weather-storm .lightning::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 18px solid #fbbf24;
            left: 4px;
            filter: drop-shadow(0 0 8px #fbbf24) drop-shadow(0 0 15px #f59e0b);
            animation: lightningFlash 3s ease-in-out infinite;
        }

        .weather-storm .lightning::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 14px solid #fcd34d;
            left: 7px;
            top: 14px;
            filter: drop-shadow(0 0 8px #fbbf24);
            animation: lightningFlash 3s ease-in-out infinite;
        }

        @keyframes lightningFlash {
            0%, 100% { opacity: 0; }
            10% { opacity: 1; }
            12% { opacity: 0; }
            14% { opacity: 1; }
            16% { opacity: 0; }
            50% { opacity: 0; }
            52% { opacity: 1; }
            54% { opacity: 0; }
        }

        .weather-storm .rain-drops {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translateX(-50%);
            width: 55px;
            height: 35px;
        }

        .weather-storm .drop {
            position: absolute;
            width: 2px;
            height: 12px;
            background: linear-gradient(180deg, transparent 0%, #60a5fa 30%, #3b82f6 100%);
            border-radius: 0 0 2px 2px;
            animation: rainFall 0.5s linear infinite;
        }

        .weather-storm .drop:nth-child(1) { left: 5px; animation-delay: 0s; }
        .weather-storm .drop:nth-child(2) { left: 12px; animation-delay: 0.1s; }
        .weather-storm .drop:nth-child(3) { left: 20px; animation-delay: 0.2s; }
        .weather-storm .drop:nth-child(4) { left: 28px; animation-delay: 0.05s; }
        .weather-storm .drop:nth-child(5) { left: 36px; animation-delay: 0.15s; }
        .weather-storm .drop:nth-child(6) { left: 44px; animation-delay: 0.25s; }

        /* === REALISTIC SNOW === */
        .weather-snow .weather-cloud {
            top: 25%;
        }

        .weather-snow .weather-cloud::before {
            background: linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 50%, #cbd5e1 100%);
        }

        .weather-snow .weather-cloud::after {
            background: linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%);
            box-shadow: 22px 6px 0 4px #e2e8f0;
        }

        .weather-snow .snowflakes {
            position: absolute;
            top: 48%;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 40px;
        }

        .weather-snow .flake {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #ffffff 0%, #e0f2fe 100%);
            border-radius: 50%;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
            animation: snowFall 2s linear infinite;
        }

        .weather-snow .flake::before,
        .weather-snow .flake::after {
            display: none;
        }

        .weather-snow .flake:nth-child(1) { left: 5px; animation-delay: 0s; width: 6px; height: 6px; }
        .weather-snow .flake:nth-child(2) { left: 15px; animation-delay: 0.4s; width: 8px; height: 8px; }
        .weather-snow .flake:nth-child(3) { left: 25px; animation-delay: 0.8s; width: 5px; height: 5px; }
        .weather-snow .flake:nth-child(4) { left: 35px; animation-delay: 0.2s; width: 7px; height: 7px; }
        .weather-snow .flake:nth-child(5) { left: 10px; animation-delay: 1s; width: 6px; height: 6px; }
        .weather-snow .flake:nth-child(6) { left: 30px; animation-delay: 0.6s; width: 5px; height: 5px; }

        @keyframes snowFall {
            0% { transform: translateY(-5px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(35px) rotate(360deg); opacity: 0; }
        }

        /* === REALISTIC NIGHT === */
        .weather-night .moon {
            position: absolute;
            width: 38px;
            height: 38px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .weather-night .moon::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #fef9c3 0%, #fde68a 50%, #fcd34d 100%);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(253, 224, 71, 0.5), 0 0 40px rgba(253, 224, 71, 0.3);
            animation: moonGlow 4s ease-in-out infinite;
        }

        .weather-night .moon::after {
            content: '';
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle at 30% 30%, transparent 0%, rgba(0, 0, 0, 0.05) 100%);
            border-radius: 50%;
            top: 4px;
            left: 4px;
        }

        .weather-night .moon .moon-inner {
            position: absolute;
            width: 10px;
            height: 10px;
            top: 8px;
            left: 10px;
            background: rgba(251, 191, 36, 0.3);
            border-radius: 50%;
            box-shadow: 12px 8px 0 3px rgba(251, 191, 36, 0.2), 5px 18px 0 2px rgba(251, 191, 36, 0.25);
        }

        @keyframes moonGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(253, 224, 71, 0.5), 0 0 40px rgba(253, 224, 71, 0.3); }
            50% { box-shadow: 0 0 30px rgba(253, 224, 71, 0.6), 0 0 50px rgba(253, 224, 71, 0.4); }
        }

        .weather-night .stars {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .weather-night .star {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ffffff;
            border-radius: 50%;
            box-shadow: 0 0 4px #ffffff;
            animation: starTwinkle 2s ease-in-out infinite;
        }

        .weather-night .star::before,
        .weather-night .star::after {
            display: none;
        }

        .weather-night .star:nth-child(1) { top: 8px; left: 12px; animation-delay: 0s; width: 3px; height: 3px; }
        .weather-night .star:nth-child(2) { top: 12px; right: 8px; animation-delay: 0.5s; width: 4px; height: 4px; }
        .weather-night .star:nth-child(3) { bottom: 15px; left: 8px; animation-delay: 1s; width: 3px; height: 3px; }
        .weather-night .star:nth-child(4) { top: 25px; left: 65px; animation-delay: 0.3s; width: 2px; height: 2px; }
        .weather-night .star:nth-child(5) { bottom: 8px; right: 12px; animation-delay: 0.8s; width: 3px; height: 3px; }

        @keyframes starTwinkle {
            0%, 100% { opacity: 0.4; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* === REALISTIC MIST === */
        .weather-mist {
            overflow: hidden;
        }

        .weather-mist .fog-line {
            position: absolute;
            height: 8px;
            background: linear-gradient(90deg, transparent 0%, rgba(226, 232, 240, 0.6) 20%, rgba(203, 213, 225, 0.8) 50%, rgba(226, 232, 240, 0.6) 80%, transparent 100%);
            border-radius: 4px;
            animation: fogDrift 4s ease-in-out infinite;
        }

        .weather-mist .fog-line:nth-child(1) { top: 15%; left: -10%; width: 80%; animation-delay: 0s; height: 6px; }
        .weather-mist .fog-line:nth-child(2) { top: 35%; left: 10%; width: 70%; animation-delay: 1s; height: 10px; }
        .weather-mist .fog-line:nth-child(3) { top: 55%; left: -5%; width: 85%; animation-delay: 2s; height: 8px; }
        .weather-mist .fog-line:nth-child(4) { top: 75%; left: 5%; width: 75%; animation-delay: 3s; height: 6px; }

        .weather-mist .fog-circle {
            display: none;
        }

        @keyframes fogDrift {
            0% { transform: translateX(0); opacity: 0.5; }
            50% { transform: translateX(15px); opacity: 0.9; }
            100% { transform: translateX(0); opacity: 0.5; }
        }

        /* Drag & Drop Placeholder */
        .drag-placeholder {
            border: 2px dashed rgba(255,255,255,0.4);
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
        }

        /* Task Search Highlight */
        .search-highlight {
            background: rgba(251, 191, 36, 0.4);
            padding: 0 2px;
            border-radius: 2px;
        }

        /* ===== WATER TRACKER STYLES ===== */
        .water-wave {
            position: absolute;
            width: 200%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 120'%3E%3Cpath fill='rgba(255,255,255,0.3)' d='M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z'/%3E%3C/svg%3E") repeat-x;
            animation: waveMove 2s linear infinite;
            left: 0;
            top: -5px;
        }

        @keyframes waveMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .water-btn:active {
            transform: scale(0.95);
        }

        .water-splash {
            animation: splash 0.5s ease-out;
        }

        @keyframes splash {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* ===== MOOD TRACKER STYLES ===== */
        .mood-emoji {
            transition: transform 0.3s ease;
        }

        .mood-emoji.bounce {
            animation: moodBounce 0.5s ease;
        }

        @keyframes moodBounce {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.3) rotate(-10deg); }
            50% { transform: scale(1.1) rotate(10deg); }
            75% { transform: scale(1.2) rotate(-5deg); }
        }

        .mood-btn {
            transition: all 0.2s ease;
        }

        .mood-btn:hover {
            transform: translateY(-3px);
        }

        .mood-btn.selected {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .mood-btn[data-mood="terrible"].selected { background: rgba(239, 68, 68, 0.4); }
        .mood-btn[data-mood="bad"].selected { background: rgba(249, 115, 22, 0.4); }
        .mood-btn[data-mood="okay"].selected { background: rgba(234, 179, 8, 0.4); }
        .mood-btn[data-mood="good"].selected { background: rgba(34, 197, 94, 0.4); }
        .mood-btn[data-mood="great"].selected { background: rgba(16, 185, 129, 0.4); }

        .mood-history-dot {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }

        .mood-history-dot:hover {
            transform: scale(1.2);
        }

        .mood-history-dot.today {
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        /* Mood Report Styles */
        .mood-chart-bar {
            background: linear-gradient(to top, rgba(236, 72, 153, 0.3), rgba(236, 72, 153, 0.6));
            border-radius: 4px 4px 0 0;
            transition: all 0.3s ease;
            position: relative;
            min-width: 20px;
        }

        .mood-chart-bar:hover {
            transform: scaleY(1.05);
            background: linear-gradient(to top, rgba(236, 72, 153, 0.5), rgba(236, 72, 153, 0.8));
        }

        .mood-chart-bar::after {
            content: attr(data-emoji);
            position: absolute;
            top: -24px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .mood-chart-bar:hover::after {
            opacity: 1;
        }

        .mood-chart-bar.terrible { background: linear-gradient(to top, rgba(239, 68, 68, 0.3), rgba(239, 68, 68, 0.7)); }
        .mood-chart-bar.bad { background: linear-gradient(to top, rgba(249, 115, 22, 0.3), rgba(249, 115, 22, 0.7)); }
        .mood-chart-bar.okay { background: linear-gradient(to top, rgba(234, 179, 8, 0.3), rgba(234, 179, 8, 0.7)); }
        .mood-chart-bar.good { background: linear-gradient(to top, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.7)); }
        .mood-chart-bar.great { background: linear-gradient(to top, rgba(16, 185, 129, 0.3), rgba(16, 185, 129, 0.7)); }
        .mood-chart-bar.empty { background: rgba(255, 255, 255, 0.1); }

        .mood-dist-bar {
            height: 8px;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .mood-trend-up {
            color: #22c55e;
        }

        .mood-trend-down {
            color: #ef4444;
        }

        .mood-trend-stable {
            color: #eab308;
        }

        .report-period-btn.active {
            background: rgba(236, 72, 153, 0.4) !important;
        }

        .insight-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .insight-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 12px;
        }

        /* ===== KANBAN STYLES ===== */
        .kanban-column {
            min-width: 300px;
            max-width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .kanban-column.drag-over {
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
        }

        .kanban-column-header {
            padding: 16px;
            border-radius: 16px 16px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: grab;
        }

        .kanban-column-header:active {
            cursor: grabbing;
        }

        .kanban-column-header.col-blue { background: linear-gradient(135deg, rgba(59, 130, 246, 0.3) 0%, rgba(59, 130, 246, 0.1) 100%); border-bottom: 2px solid #3b82f6; }
        .kanban-column-header.col-purple { background: linear-gradient(135deg, rgba(168, 85, 247, 0.3) 0%, rgba(168, 85, 247, 0.1) 100%); border-bottom: 2px solid #a855f7; }
        .kanban-column-header.col-green { background: linear-gradient(135deg, rgba(34, 197, 94, 0.3) 0%, rgba(34, 197, 94, 0.1) 100%); border-bottom: 2px solid #22c55e; }
        .kanban-column-header.col-yellow { background: linear-gradient(135deg, rgba(234, 179, 8, 0.3) 0%, rgba(234, 179, 8, 0.1) 100%); border-bottom: 2px solid #eab308; }
        .kanban-column-header.col-red { background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.1) 100%); border-bottom: 2px solid #ef4444; }
        .kanban-column-header.col-pink { background: linear-gradient(135deg, rgba(236, 72, 153, 0.3) 0%, rgba(236, 72, 153, 0.1) 100%); border-bottom: 2px solid #ec4899; }
        .kanban-column-header.col-cyan { background: linear-gradient(135deg, rgba(6, 182, 212, 0.3) 0%, rgba(6, 182, 212, 0.1) 100%); border-bottom: 2px solid #06b6d4; }
        .kanban-column-header.col-orange { background: linear-gradient(135deg, rgba(249, 115, 22, 0.3) 0%, rgba(249, 115, 22, 0.1) 100%); border-bottom: 2px solid #f97316; }

        .kanban-column-body {
            flex: 1;
            padding: 12px;
            overflow-y: auto;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .kanban-card {
            transform: rotate(var(--rotation, 0deg));
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 3px 3px 10px rgba(0,0,0,0.3);
            cursor: grab;
        }

        .kanban-card:hover {
            transform: rotate(0deg) scale(1.02) translateY(-2px);
            z-index: 100;
            box-shadow: 8px 8px 20px rgba(0,0,0,0.4);
        }

        .kanban-card.dragging {
            cursor: grabbing;
            transform: rotate(0deg) scale(1.05);
            z-index: 1000;
            box-shadow: 12px 12px 30px rgba(0,0,0,0.5);
            opacity: 0.9;
        }

        .kanban-card.drag-ghost {
            opacity: 0.4;
        }

        .kanban-drop-zone {
            min-height: 60px;
            border: 2px dashed transparent;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .kanban-drop-zone.active {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.05);
        }

        .kanban-drop-zone.active::after {
            content: 'Solte aqui';
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.875rem;
        }

        .column-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .column-actions {
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .kanban-column-header:hover .column-actions {
            opacity: 1;
        }

        .column-action-btn {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            transition: all 0.2s;
        }

        .column-action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Scrollbar for kanban */
        .kanban-column-body::-webkit-scrollbar {
            width: 6px;
        }

        .kanban-column-body::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 3px;
        }

        .kanban-column-body::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
        }

        /* Empty column state */
        .empty-column-message {
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.4);
            font-size: 0.875rem;
        }

        /* Card completed state */
        .kanban-card.completed {
            opacity: 0.7;
        }

        .kanban-card.completed .card-title {
            text-decoration: line-through;
        }

        /* ===== MOBILE RESPONSIVE ===== */
        
        /* Splash Screen Mobile */
        @media (max-width: 640px) {
            .jarvis-hologram {
                width: 250px;
                height: 250px;
            }
            
            .splash-name {
                font-size: 2.5rem;
            }
            
            .splash-greeting {
                font-size: 1rem;
                letter-spacing: 2px;
            }
            
            .splash-tagline {
                font-size: 0.75rem;
            }
            
            .jarvis-status {
                gap: 15px;
                bottom: 120px;
            }
            
            .status-item {
                font-size: 0.6rem;
            }
            
            .jarvis-loader {
                width: 160px;
                bottom: 60px;
            }
            
            .hud-corner {
                width: 25px;
                height: 25px;
            }
            
            .data-point {
                width: 6px;
                height: 6px;
            }
        }
        
        /* General Mobile Adjustments */
        @media (max-width: 768px) {
            /* Quote */
            #quoteContainer {
                padding: 0.5rem 1rem;
            }
            
            #quoteText {
                font-size: 0.75rem;
            }
            
            /* Search Bar */
            .search-bar {
                padding: 0.5rem;
            }
            
            .search-bar input {
                font-size: 1rem;
                padding: 0.5rem;
            }
            
            .search-bar button {
                padding: 0.5rem 1rem;
            }
            
            /* Links Section */
            #linksContainer {
                padding: 0.75rem;
            }
            
            #linksContainer h3 {
                font-size: 0.875rem;
            }
            
            #linksContainer .flex.gap-2 {
                flex-wrap: wrap;
            }
            
            #linksContainer button,
            #linksContainer select {
                font-size: 0.7rem;
                padding: 0.35rem 0.5rem;
            }
            
            #linksGrid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 0.5rem;
            }
            
            .link-item {
                padding: 0.5rem;
            }
            
            .link-item img {
                width: 1.25rem;
                height: 1.25rem;
            }
            
            .link-item i {
                font-size: 1.25rem;
            }
            
            .link-item span {
                font-size: 0.6rem;
            }
            
            /* Sidebar Widgets */
            .lg\\:col-span-3 > div {
                padding: 1rem;
            }
            
            /* Clock */
            #clock {
                font-size: 3rem;
            }
            
            #seconds {
                font-size: 1.25rem;
            }
            
            #date {
                font-size: 0.875rem;
            }
            
            /* Weather */
            .weather-icon {
                width: 60px;
                height: 60px;
            }
            
            #temperature {
                font-size: 2rem;
            }
            
            /* Pomodoro */
            .pomodoro-progress-container svg {
                width: 100px;
                height: 100px;
            }
            
            #pomodoroTime {
                font-size: 1.5rem;
            }
            
            /* Kanban */
            .kanban-column {
                min-width: 260px;
                max-width: 260px;
            }
            
            .kanban-column-header {
                padding: 12px;
            }
            
            .kanban-column-body {
                padding: 8px;
                min-height: 300px;
            }
            
            /* Kanban Header */
            .lg\\:col-span-9 .glass-dark {
                padding: 1rem;
            }
            
            .lg\\:col-span-9 h3 {
                font-size: 1rem;
            }
            
            #taskCounter {
                font-size: 0.65rem;
                padding: 0.25rem 0.5rem;
            }
            
            /* Task Filters */
            .flex.flex-wrap.gap-2.mb-4 {
                gap: 0.5rem;
            }
            
            .flex.flex-wrap.gap-2.mb-4 input,
            .flex.flex-wrap.gap-2.mb-4 select {
                font-size: 0.75rem;
                padding: 0.5rem;
            }
            
            /* Buttons */
            .lg\\:col-span-9 .flex.gap-2 button {
                font-size: 0.75rem;
                padding: 0.5rem 0.75rem;
            }
            
            /* Modals */
            .fixed.inset-0 > div {
                margin: 1rem;
                padding: 1rem;
                max-height: 85vh;
            }
            
            .fixed.inset-0 h3 {
                font-size: 1.125rem;
            }
            
            .fixed.inset-0 input,
            .fixed.inset-0 select,
            .fixed.inset-0 textarea {
                padding: 0.75rem;
                font-size: 0.875rem;
            }
            
            .fixed.inset-0 button {
                padding: 0.75rem;
            }
            
            /* Color & Priority Buttons in Modal */
            .color-btn,
            .column-color-btn {
                width: 2rem;
                height: 2rem;
            }
            
            .priority-btn {
                font-size: 0.75rem;
                padding: 0.5rem;
            }
        }
        
        /* Extra Small Devices */
        @media (max-width: 480px) {
            .main-content {
                padding: 0.5rem;
            }
            
            /* Links Grid - 3 columns on very small screens */
            #linksGrid {
                grid-template-columns: repeat(3, 1fr) !important;
            }
            
            /* Hide some link buttons on mobile */
            #linksContainer .flex.gap-2 button:not(:last-child):not(:nth-last-child(2)) {
                display: none;
            }
            
            /* Stack header elements */
            .lg\\:col-span-9 > .glass-dark > .flex:first-child {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }
            
            .lg\\:col-span-9 > .glass-dark > .flex:first-child > .flex:first-child {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .lg\\:col-span-9 > .glass-dark > .flex:first-child > .flex:last-child {
                justify-content: center;
            }
            
            /* Kanban columns smaller */
            .kanban-column {
                min-width: 240px;
                max-width: 240px;
            }
            
            /* Filters - 2 columns */
            .flex.flex-wrap.gap-2.mb-4 {
                display: grid;
                grid-template-columns: 1fr 1fr;
            }
            
            .flex.flex-wrap.gap-2.mb-4 > div:first-child {
                grid-column: 1 / -1;
            }
            
            /* Quote */
            #quoteContainer {
                display: none;
            }
        }
        
        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            /* Make touch targets bigger */
            .link-item {
                min-height: 60px;
            }
            
            button {
                min-height: 44px;
            }
            
            /* Show delete buttons on mobile */
            .link-item button,
            .kanban-card button {
                opacity: 1;
            }
            
            /* Disable hover effects that don't work well on touch */
            .post-it:hover,
            .kanban-card:hover {
                transform: rotate(var(--rotation, 0deg));
            }
            
            /* Make column actions always visible on touch */
            .column-actions {
                opacity: 1;
            }
            
            /* Larger touch area for drag */
            .kanban-card {
                padding: 1rem;
            }
        }
        
        /* Landscape Mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .splash-screen {
                padding: 1rem;
            }
            
            .jarvis-hologram {
                width: 180px;
                height: 180px;
            }
            
            .splash-name {
                font-size: 2rem;
            }
            
            .jarvis-status {
                bottom: 80px;
            }
            
            .jarvis-loader {
                bottom: 30px;
            }
        }
        
        /* Tablet Portrait */
        @media (min-width: 768px) and (max-width: 1024px) {
            .lg\\:col-span-3 {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .lg\\:col-span-3 > div:first-child {
                grid-column: 1 / -1;
            }
        }
        
        /* Improve scroll on mobile */
        @media (max-width: 1024px) {
            #kanbanBoard {
                scroll-snap-type: x mandatory;
                -webkit-overflow-scrolling: touch;
            }
            
            .kanban-column {
                scroll-snap-align: start;
                flex-shrink: 0;
            }
            
            /* Add padding to last column for scroll */
            .kanban-column:last-child {
                margin-right: 1rem;
            }
        }
        
        /* Safe area for notched phones */
        @supports (padding: max(0px)) {
            .main-content {
                padding-left: max(1rem, env(safe-area-inset-left));
                padding-right: max(1rem, env(safe-area-inset-right));
                padding-bottom: max(1rem, env(safe-area-inset-bottom));
            }
        }

        /* ===== FOCUS MODE ===== */
        .focus-mode-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 8000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .focus-mode-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .focus-mode-content {
            text-align: center;
            max-width: 500px;
            padding: 40px;
        }

        .focus-timer {
            font-size: 8rem;
            font-weight: 700;
            font-family: 'Space Grotesk', sans-serif;
            background: linear-gradient(135deg, #22d3ee 0%, #3b82f6 50%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 60px rgba(34, 211, 238, 0.5);
            line-height: 1;
        }

        .focus-task {
            font-size: 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .focus-message {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 30px;
        }

        .focus-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .focus-btn {
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .focus-btn-pause {
            background: rgba(234, 179, 8, 0.3);
            color: #fbbf24;
        }

        .focus-btn-pause:hover {
            background: rgba(234, 179, 8, 0.5);
        }

        .focus-btn-stop {
            background: rgba(239, 68, 68, 0.3);
            color: #f87171;
        }

        .focus-btn-stop:hover {
            background: rgba(239, 68, 68, 0.5);
        }

        .focus-progress-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            opacity: 0.3;
        }

        .focus-progress-ring circle {
            fill: none;
            stroke-width: 4;
            stroke-linecap: round;
        }

        .focus-breathing {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: rgba(255, 255, 255, 0.4);
        }

        .breathing-circle {
            width: 20px;
            height: 20px;
            background: rgba(34, 211, 238, 0.5);
            border-radius: 50%;
            margin: 0 auto 10px;
            animation: breathe 4s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.5); opacity: 1; }
        }

        /* ===== KEYBOARD SHORTCUTS HELP ===== */
        .shortcuts-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 9500;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .shortcuts-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .shortcuts-content {
            background: rgba(30, 30, 50, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .shortcut-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .shortcut-item:last-child {
            border-bottom: none;
        }

        .shortcut-key {
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .shortcut-key kbd {
            background: rgba(255, 255, 255, 0.15);
            padding: 5px 10px;
            border-radius: 6px;
            font-family: 'Space Grotesk', monospace;
            font-size: 0.85rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 0 rgba(0, 0, 0, 0.3);
        }

        /* ===== WATER REMINDER ===== */
        .water-reminder-popup {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.9) 0%, rgba(59, 130, 246, 0.9) 100%);
            padding: 20px 30px;
            border-radius: 16px;
            z-index: 9600;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 10px 40px rgba(6, 182, 212, 0.4);
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .water-reminder-popup.show {
            transform: translateX(-50%) translateY(0);
        }

        .water-reminder-popup .water-icon {
            font-size: 2.5rem;
            animation: waterBounce 0.5s ease infinite;
        }

        @keyframes waterBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .water-reminder-popup button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: background 0.2s;
        }

        .water-reminder-popup button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* ===== TOAST NOTIFICATIONS =====
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .toast {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 14px 20px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 280px;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            transform: translateX(120%);
            animation: toastSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            pointer-events: auto;
        }

        .toast.hiding {
            animation: toastSlideOut 0.3s ease forwards;
        }

        @keyframes toastSlideIn {
            from { transform: translateX(120%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes toastSlideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(120%); opacity: 0; }
        }

        .toast-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }

        .toast-success .toast-icon { background: #22c55e; }
        .toast-error .toast-icon { background: #ef4444; }
        .toast-warning .toast-icon { background: #f59e0b; }
        .toast-info .toast-icon { background: #3b82f6; }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .toast-message {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .toast-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            color: white;
        }

        .toast-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .toast-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 0 0 12px 12px;
            animation: toastProgress 4s linear forwards;
        }

        @keyframes toastProgress {
            from { width: 100%; }
            to { width: 0%; }
        }

        /* ===== CONFIRM MODAL ===== */
        .confirm-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .confirm-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .confirm-modal-content {
            background: rgba(30, 30, 50, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .confirm-modal.active .confirm-modal-content {
            transform: scale(1);
        }

        .confirm-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(239, 68, 68, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 24px;
        }

        .confirm-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .confirm-message {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-bottom: 24px;
        }

        .confirm-buttons {
            display: flex;
            gap: 12px;
        }

        .confirm-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
        }

        .confirm-btn-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .confirm-btn-cancel:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .confirm-btn-confirm {
            background: #ef4444;
            color: white;
        }

        .confirm-btn-confirm:hover {
            background: #dc2626;
        }

        /* ===== FORECAST MODAL ===== */
        .forecast-day {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.2s ease;
        }

        .forecast-day:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .forecast-day-name {
            font-weight: 500;
            min-width: 80px;
        }

        .forecast-day-icon {
            font-size: 1.5rem;
            min-width: 40px;
            text-align: center;
        }

        .forecast-day-desc {
            flex: 1;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.6);
            text-align: center;
        }

        .forecast-day-temps {
            display: flex;
            gap: 8px;
            font-weight: 600;
            min-width: 80px;
            justify-content: flex-end;
        }

        .forecast-temp-max {
            color: #fbbf24;
        }

        .forecast-temp-min {
            color: #60a5fa;
        }

        .forecast-rain {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.7rem;
            color: rgba(96, 165, 250, 0.8);
            min-width: 45px;
        }

        /* Mobile Toast */
        @media (max-width: 480px) {
            .toast-container {
                left: 10px;
                right: 10px;
                top: 10px;
            }

            .toast {
                min-width: auto;
                width: 100%;
            }
        }
    </style>
</head>
<body class="min-h-screen text-white overflow-x-hidden">
    <!-- Splash Screen - Jarvis Style -->
    <div id="splashScreen" class="splash-screen">
        <!-- Background Effects -->
        <div class="jarvis-grid"></div>
        <div class="hexagon-pattern"></div>
        
        <!-- Floating Particles -->
        <div class="jarvis-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>

        <!-- Central Hologram -->
        <div class="jarvis-hologram">
            <!-- HUD Corners -->
            <div class="hud-corner hud-corner-tl"></div>
            <div class="hud-corner hud-corner-tr"></div>
            <div class="hud-corner hud-corner-bl"></div>
            <div class="hud-corner hud-corner-br"></div>
            
            <!-- Rotating Circles -->
            <div class="jarvis-circle jarvis-circle-1"></div>
            <div class="jarvis-circle jarvis-circle-2"></div>
            <div class="jarvis-circle jarvis-circle-3"></div>
            <div class="jarvis-circle jarvis-circle-4"></div>
            <div class="jarvis-circle jarvis-circle-5"></div>
            
            <!-- Arc Segments -->
            <div class="jarvis-arc jarvis-arc-1"></div>
            <div class="jarvis-arc jarvis-arc-2"></div>
            
            <!-- Scan Line -->
            <div class="jarvis-scan"></div>
            
            <!-- Data Points -->
            <div class="jarvis-data-points">
                <div class="data-point"></div>
                <div class="data-point"></div>
                <div class="data-point"></div>
                <div class="data-point"></div>
                <div class="data-point"></div>
                <div class="data-point"></div>
                <div class="data-point"></div>
                <div class="data-point"></div>
            </div>
            
            <!-- Connection Lines -->
            <div class="jarvis-connections">
                <div class="connection-line"></div>
                <div class="connection-line"></div>
                <div class="connection-line"></div>
                <div class="connection-line"></div>
            </div>
            
            <!-- Text Content -->
            <div class="jarvis-content">
                <p class="splash-greeting title-font" id="splashGreeting">Bom dia,</p>
                <h1 class="splash-name title-font">FILIPE</h1>
                <p class="splash-tagline">Iniciando sistema...</p>
            </div>
        </div>

        <!-- Status Indicators -->
        <div class="jarvis-status">
            <div class="status-item">
                <div class="status-dot"></div>
                <span>Sistema</span>
            </div>
            <div class="status-item">
                <div class="status-dot loading"></div>
                <span>Dados</span>
            </div>
            <div class="status-item">
                <div class="status-dot"></div>
                <span>ConexÃ£o</span>
            </div>
        </div>

        <!-- Loading Bar -->
        <div class="jarvis-loader">
            <div class="loader-bar">
                <div class="loader-progress"></div>
            </div>
            <div class="loader-text">
                Carregando dashboard... <span class="loader-percentage" id="loaderPercentage">0%</span>
            </div>
        </div>
    </div>

    <!-- Parallax Background -->
    <div id="parallaxBg" class="parallax-bg"></div>
    <div class="parallax-overlay"></div>

    <!-- Main Container -->
    <div id="mainContent" class="main-content min-h-screen p-4 md:p-6">
        <!-- Top Bar with Settings -->
        <div class="flex justify-between items-center mb-3 px-2">
            <button onclick="openShortcutsModal()" class="text-white/50 hover:text-white/80 transition text-sm">
                <i class="fas fa-keyboard mr-1"></i>
                <span class="hidden sm:inline">Atalhos</span>
            </button>
            
            <!-- Motivational Quote -->
            <div id="quoteContainer" class="glass-dark rounded-xl px-6 py-2 text-center max-w-2xl">
                <p id="quoteText" class="text-sm italic text-white/80 quote-fade">"Carregando frase..."</p>
                <p id="quoteAuthor" class="text-xs text-white/50 mt-1"></p>
            </div>
            
            <button onclick="openSettingsModal()" class="text-white/50 hover:text-white/80 transition text-sm">
                <i class="fas fa-cog mr-1"></i>
                <span class="hidden sm:inline">ConfiguraÃ§Ãµes</span>
            </button>
        </div>

        <!-- Search Bar -->
        <div class="flex justify-center mb-4 px-2">
            <div class="search-bar glass-dark rounded-2xl p-2 w-full max-w-2xl flex items-center gap-2 sm:gap-3">
                <i class="fas fa-search text-white/60 ml-2 sm:ml-4 text-sm sm:text-base"></i>
                <input type="text" id="searchInput" placeholder="Pesquisar no Google..." 
                    class="bg-transparent border-none outline-none text-white placeholder-white/50 w-full py-1 sm:py-2 text-sm sm:text-lg">
                <button onclick="search()" class="bg-white/20 hover:bg-white/30 px-4 sm:px-6 py-2 rounded-xl transition">
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Links Section -->
        <div class="mb-6">
            <div id="linksContainer" class="glass-dark rounded-2xl p-4 max-w-5xl mx-auto">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 mb-3">
                    <h3 class="title-font font-semibold text-white/80 text-sm sm:text-base"><i class="fas fa-bookmark mr-2"></i>Links Favoritos</h3>
                    <div class="flex flex-wrap gap-2">
                        <select id="linkFolderFilter" onchange="filterLinksByFolder()" class="bg-white/20 hover:bg-white/30 px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm outline-none cursor-pointer">
                            <option value="all">Todas Pastas</option>
                        </select>
                        <button onclick="openAddFolderModal()" class="bg-white/20 hover:bg-white/30 px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm transition hidden sm:inline-flex items-center">
                            <i class="fas fa-folder-plus mr-1"></i><span class="hidden md:inline">Pasta</span>
                        </button>
                        <button onclick="openAddLinkModal()" class="bg-white/20 hover:bg-white/30 px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm transition">
                            <i class="fas fa-plus mr-1"></i><span class="hidden sm:inline">Adicionar</span>
                        </button>
                        <button onclick="toggleLinks()" id="expandBtn" class="bg-white/20 hover:bg-white/30 px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm transition">
                            <i class="fas fa-chevron-down mr-1"></i><span class="hidden sm:inline">Expandir</span>
                        </button>
                    </div>
                </div>
                <div id="linksGrid" class="grid grid-cols-3 sm:grid-cols-5 md:grid-cols-9 gap-3 overflow-hidden transition-all duration-300" style="max-height: 100px;">
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
            <!-- Left Sidebar -->
            <div class="lg:col-span-3 space-y-4">
                <!-- Clock & Date -->
                <div class="glass-dark rounded-2xl p-5">
                    <div class="text-center">
                        <div id="clock" class="title-font text-5xl font-bold mb-2">00:00</div>
                        <div id="seconds" class="text-2xl text-white/60 mb-2">00</div>
                        <div id="date" class="text-lg text-white/80"></div>
                    </div>
                </div>

                <!-- Weather -->
                <div class="glass-dark rounded-2xl p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="title-font font-semibold"><i class="fas fa-cloud-sun mr-2"></i>Clima</h3>
                        <div class="flex items-center gap-2">
                            <span class="text-sm text-white/60">ItatiaiuÃ§u</span>
                            <button id="weatherRefreshBtn" onclick="fetchWeather()" class="text-xs bg-white/20 hover:bg-white/30 px-2 py-1 rounded-lg transition hidden" title="Atualizar clima">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div id="weatherInfo" class="text-center">
                        <!-- Loading State -->
                        <div id="weatherLoading" class="hidden">
                            <div class="weather-icon mb-4 flex items-center justify-center">
                                <i class="fas fa-spinner fa-spin text-3xl text-white/50"></i>
                            </div>
                            <div class="text-white/50">Carregando clima...</div>
                        </div>
                        
                        <!-- Error State -->
                        <div id="weatherError" class="hidden">
                            <div class="weather-icon mb-4 flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-3xl text-yellow-400"></i>
                            </div>
                            <div class="text-white/70 mb-2">NÃ£o foi possÃ­vel carregar o clima</div>
                            <button onclick="fetchWeather()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm transition">
                                <i class="fas fa-redo mr-2"></i>Tentar novamente
                            </button>
                            <div id="weatherErrorDetails" class="text-xs text-white/40 mt-2"></div>
                        </div>
                        
                        <!-- Success State -->
                        <div id="weatherContent">
                            <div id="weatherIconContainer" class="weather-icon mb-4">
                                <div class="weather-sun"></div>
                            </div>
                            <div id="temperature" class="text-4xl font-bold title-font">--Â°C</div>
                            <div id="weatherDesc" class="text-white/70 capitalize mt-1">Carregando...</div>
                            <div class="grid grid-cols-2 gap-2 mt-4 text-sm">
                                <div class="bg-white/10 rounded-lg p-2">
                                    <i class="fas fa-tint text-blue-300"></i>
                                    <span id="humidity" class="ml-1">--%</span>
                                </div>
                                <div class="bg-white/10 rounded-lg p-2">
                                    <i class="fas fa-wind text-gray-300"></i>
                                    <span id="wind" class="ml-1">-- km/h</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Last Update -->
                        <div id="weatherLastUpdate" class="text-[10px] text-white/30 mt-3"></div>
                        
                        <!-- Forecast Button -->
                        <button onclick="openForecastModal()" class="mt-3 w-full bg-white/10 hover:bg-white/20 py-2 rounded-lg text-sm transition flex items-center justify-center gap-2">
                            <i class="fas fa-calendar-week"></i>
                            <span>Ver previsÃ£o 5 dias</span>
                        </button>
                    </div>
                </div>

                <!-- Pomodoro -->
                <div class="glass-dark rounded-2xl p-5">
                    <h3 class="title-font font-semibold mb-4"><i class="fas fa-clock mr-2"></i>Pomodoro</h3>
                    <div class="flex justify-center mb-4">
                        <div class="relative">
                            <svg class="w-32 h-32 transform -rotate-90">
                                <circle cx="64" cy="64" r="58" stroke="rgba(255,255,255,0.1)" stroke-width="8" fill="none"/>
                                <circle id="pomodoroProgress" cx="64" cy="64" r="58" stroke="#ef4444" stroke-width="8" fill="none"
                                    stroke-dasharray="364.42" stroke-dashoffset="0" class="pomodoro-progress"/>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <span id="pomodoroTime" class="text-3xl font-bold title-font">25:00</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-center gap-2 mb-3">
                        <button onclick="startPomodoro()" id="pomodoroStart" class="bg-green-500/80 hover:bg-green-500 px-4 py-2 rounded-lg transition">
                            <i class="fas fa-play"></i>
                        </button>
                        <button onclick="pausePomodoro()" class="bg-yellow-500/80 hover:bg-yellow-500 px-4 py-2 rounded-lg transition">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button onclick="resetPomodoro()" class="bg-red-500/80 hover:bg-red-500 px-4 py-2 rounded-lg transition">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                    <div class="flex justify-center gap-2 text-sm">
                        <button onclick="setPomodoro(25)" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded-lg transition">25min</button>
                        <button onclick="setPomodoro(5)" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded-lg transition">5min</button>
                        <button onclick="setPomodoro(15)" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded-lg transition">15min</button>
                    </div>
                    <div class="text-center mt-3 text-sm text-white/60">
                        <span id="pomodoroMode">Modo: Foco</span> | <span id="pomodoroCount">SessÃµes: 0</span>
                    </div>
                </div>

                <!-- Water Tracker -->
                <div class="glass-dark rounded-2xl p-5">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="title-font font-semibold"><i class="fas fa-tint mr-2 text-blue-400"></i>Ãgua</h3>
                        <button onclick="resetWater()" class="text-xs bg-white/20 hover:bg-white/30 px-2 py-1 rounded-lg transition">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                    
                    <!-- Water Glass Animation -->
                    <div class="flex justify-center mb-4">
                        <div class="relative w-24 h-32">
                            <!-- Glass Container -->
                            <div class="absolute inset-0 border-4 border-white/30 rounded-b-3xl rounded-t-lg overflow-hidden">
                                <!-- Water Fill -->
                                <div id="waterFill" class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-blue-500 to-cyan-400 transition-all duration-500 ease-out" style="height: 0%;">
                                    <!-- Water Waves -->
                                    <div class="absolute top-0 left-0 right-0 h-3 overflow-hidden">
                                        <div class="water-wave"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Glass Shine -->
                            <div class="absolute top-2 left-2 w-2 h-16 bg-white/20 rounded-full"></div>
                        </div>
                    </div>
                    
                    <!-- Water Count -->
                    <div class="text-center mb-4">
                        <span id="waterCount" class="text-4xl font-bold title-font text-blue-400">0</span>
                        <span class="text-lg text-white/60"> / </span>
                        <span id="waterGoal" class="text-lg text-white/60">8 copos</span>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="h-2 bg-white/10 rounded-full mb-4 overflow-hidden">
                        <div id="waterProgress" class="h-full bg-gradient-to-r from-blue-500 to-cyan-400 rounded-full transition-all duration-500" style="width: 0%;"></div>
                    </div>
                    
                    <!-- Water Buttons -->
                    <div class="grid grid-cols-4 gap-2">
                        <button onclick="addWater(1)" class="water-btn bg-blue-500/30 hover:bg-blue-500/50 p-2 rounded-lg transition text-center">
                            <i class="fas fa-plus text-xs"></i>
                            <span class="block text-xs mt-1">1</span>
                        </button>
                        <button onclick="addWater(2)" class="water-btn bg-blue-500/30 hover:bg-blue-500/50 p-2 rounded-lg transition text-center">
                            <i class="fas fa-plus text-xs"></i>
                            <span class="block text-xs mt-1">2</span>
                        </button>
                        <button onclick="removeWater(1)" class="water-btn bg-red-500/30 hover:bg-red-500/50 p-2 rounded-lg transition text-center">
                            <i class="fas fa-minus text-xs"></i>
                            <span class="block text-xs mt-1">1</span>
                        </button>
                        <button onclick="setWaterGoal()" class="water-btn bg-white/20 hover:bg-white/30 p-2 rounded-lg transition text-center">
                            <i class="fas fa-cog text-xs"></i>
                            <span class="block text-xs mt-1">Meta</span>
                        </button>
                    </div>
                    
                    <!-- Hydration Message -->
                    <div id="waterMessage" class="text-center mt-3 text-xs text-white/60">
                        <span>ðŸ’§ Mantenha-se hidratado!</span>
                    </div>
                </div>

                <!-- Mood Tracker -->
                <div class="glass-dark rounded-2xl p-5">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="title-font font-semibold"><i class="fas fa-heart mr-2 text-pink-400"></i>Humor</h3>
                        <div class="flex items-center gap-2">
                            <button onclick="openMoodReportModal()" class="text-xs bg-white/20 hover:bg-white/30 px-2 py-1 rounded-lg transition" title="Ver relatÃ³rio semanal">
                                <i class="fas fa-chart-line"></i>
                            </button>
                            <span id="moodDate" class="text-xs text-white/50"></span>
                        </div>
                    </div>
                    
                    <!-- Current Mood Display -->
                    <div id="currentMoodDisplay" class="text-center mb-4">
                        <div id="currentMoodEmoji" class="text-6xl mb-2 mood-emoji">ðŸ˜Š</div>
                        <div id="currentMoodText" class="text-sm text-white/70">Como vocÃª estÃ¡ hoje?</div>
                    </div>
                    
                    <!-- Mood Selection -->
                    <div class="grid grid-cols-5 gap-2 mb-4">
                        <button onclick="setMood('terrible')" class="mood-btn p-2 rounded-xl bg-white/10 hover:bg-red-500/30 transition flex flex-col items-center" data-mood="terrible">
                            <span class="text-2xl">ðŸ˜¢</span>
                            <span class="text-[10px] mt-1 opacity-70">PÃ©ssimo</span>
                        </button>
                        <button onclick="setMood('bad')" class="mood-btn p-2 rounded-xl bg-white/10 hover:bg-orange-500/30 transition flex flex-col items-center" data-mood="bad">
                            <span class="text-2xl">ðŸ˜”</span>
                            <span class="text-[10px] mt-1 opacity-70">Mal</span>
                        </button>
                        <button onclick="setMood('okay')" class="mood-btn p-2 rounded-xl bg-white/10 hover:bg-yellow-500/30 transition flex flex-col items-center" data-mood="okay">
                            <span class="text-2xl">ðŸ˜</span>
                            <span class="text-[10px] mt-1 opacity-70">Ok</span>
                        </button>
                        <button onclick="setMood('good')" class="mood-btn p-2 rounded-xl bg-white/10 hover:bg-green-500/30 transition flex flex-col items-center" data-mood="good">
                            <span class="text-2xl">ðŸ˜Š</span>
                            <span class="text-[10px] mt-1 opacity-70">Bem</span>
                        </button>
                        <button onclick="setMood('great')" class="mood-btn p-2 rounded-xl bg-white/10 hover:bg-emerald-500/30 transition flex flex-col items-center" data-mood="great">
                            <span class="text-2xl">ðŸ¤©</span>
                            <span class="text-[10px] mt-1 opacity-70">Ã“timo</span>
                        </button>
                    </div>
                    
                    <!-- Mood Note -->
                    <div class="relative">
                        <input type="text" id="moodNote" placeholder="Adicione uma nota..." 
                            onchange="saveMoodNote()"
                            class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-sm outline-none focus:border-white/40 transition">
                    </div>
                    
                    <!-- Mood History (last 7 days) -->
                    <div class="mt-4">
                        <div class="flex items-center justify-between mb-2">
                            <p class="text-xs text-white/50">Ãšltimos 7 dias:</p>
                            <div id="moodTrend" class="text-xs"></div>
                        </div>
                        <div id="moodHistory" class="flex justify-between">
                            <!-- Will be populated by JS -->
                        </div>
                    </div>
                    
                    <!-- Weekly Average Mini -->
                    <div id="moodWeeklyMini" class="mt-3 pt-3 border-t border-white/10 text-center">
                        <div class="flex items-center justify-center gap-2">
                            <span class="text-xs text-white/50">MÃ©dia semanal:</span>
                            <span id="moodAvgEmoji" class="text-lg">ðŸ˜Š</span>
                            <span id="moodAvgScore" class="text-xs font-semibold text-white/70"></span>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Kanban Section -->
            <div class="lg:col-span-9">
                <div class="glass-dark rounded-2xl p-5 min-h-[600px]">
                    <!-- Kanban Header -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3 w-full sm:w-auto">
                            <h3 class="title-font font-semibold text-lg sm:text-xl"><i class="fas fa-columns mr-2"></i>Kanban</h3>
                            <div id="taskCounter" class="text-xs sm:text-sm text-white/60 bg-white/10 px-2 sm:px-3 py-1 rounded-full">
                                <span id="todoCount">0</span> a fazer | <span id="doingCount">0</span> fazendo | <span id="doneCount">0</span> feitas
                            </div>
                        </div>
                        <div class="flex gap-2 w-full sm:w-auto flex-wrap justify-end">
                            <button onclick="exportData()" class="bg-white/20 hover:bg-white/30 px-3 py-2 rounded-xl transition text-xs sm:text-sm" title="Exportar dados">
                                <i class="fas fa-download"></i><span class="hidden md:inline ml-2">Exportar</span>
                            </button>
                            <button onclick="document.getElementById('importFile').click()" class="bg-white/20 hover:bg-white/30 px-3 py-2 rounded-xl transition text-xs sm:text-sm" title="Importar dados">
                                <i class="fas fa-upload"></i><span class="hidden md:inline ml-2">Importar</span>
                            </button>
                            <input type="file" id="importFile" accept=".json" onchange="importData(event)" class="hidden">
                            <button onclick="openAddColumnModal()" class="bg-white/20 hover:bg-white/30 px-3 sm:px-4 py-2 rounded-xl transition font-medium text-xs sm:text-sm">
                                <i class="fas fa-plus mr-1 sm:mr-2"></i><span class="hidden sm:inline">Nova </span>Coluna
                            </button>
                            <button onclick="openAddNoteModal()" class="bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 px-3 sm:px-4 py-2 rounded-xl transition font-medium text-xs sm:text-sm">
                                <i class="fas fa-plus mr-1 sm:mr-2"></i><span class="hidden sm:inline">Nova </span>Tarefa
                            </button>
                        </div>
                    </div>
                    
                    <!-- Task Filters -->
                    <div class="grid grid-cols-2 sm:flex sm:flex-wrap gap-2 mb-4">
                        <div class="col-span-2 sm:flex-1 sm:min-w-[200px]">
                            <div class="relative">
                                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-white/40 text-sm"></i>
                                <input type="text" id="taskSearch" placeholder="Buscar..." 
                                    oninput="filterTasks()"
                                    class="w-full bg-white/10 border border-white/20 rounded-lg pl-9 pr-3 py-2 text-xs sm:text-sm outline-none focus:border-white/40 transition">
                            </div>
                        </div>
                        <select id="filterCategory" onchange="filterTasks()" class="bg-white/10 border border-white/20 rounded-lg px-2 sm:px-3 py-2 text-xs sm:text-sm outline-none cursor-pointer">
                            <option value="all">Categoria</option>
                            <option value="trabalho">ðŸ’¼ Trabalho</option>
                            <option value="pessoal">ðŸ  Pessoal</option>
                            <option value="estudos">ðŸ“š Estudos</option>
                            <option value="saude">â¤ï¸ SaÃºde</option>
                            <option value="financeiro">ðŸ’° Financeiro</option>
                            <option value="outros">ðŸ“Œ Outros</option>
                        </select>
                        <select id="filterPriority" onchange="filterTasks()" class="bg-white/10 border border-white/20 rounded-lg px-2 sm:px-3 py-2 text-xs sm:text-sm outline-none cursor-pointer">
                            <option value="all">Prioridade</option>
                            <option value="high">ðŸ”´ Alta</option>
                            <option value="medium">ðŸŸ¡ MÃ©dia</option>
                            <option value="low">ðŸŸ¢ Baixa</option>
                        </select>
                        <select id="filterColor" onchange="filterTasks()" class="col-span-2 sm:col-span-1 bg-white/10 border border-white/20 rounded-lg px-2 sm:px-3 py-2 text-xs sm:text-sm outline-none cursor-pointer">
                            <option value="all">Cor</option>
                            <option value="yellow">ðŸŸ¡ Amarelo</option>
                            <option value="pink">ðŸ©· Rosa</option>
                            <option value="blue">ðŸ”µ Azul</option>
                            <option value="green">ðŸŸ¢ Verde</option>
                            <option value="orange">ðŸŸ  Laranja</option>
                            <option value="purple">ðŸŸ£ Roxo</option>
                        </select>
                    </div>
                    
                    <!-- Kanban Board -->
                    <div id="kanbanBoard" class="flex gap-4 overflow-x-auto pb-4 min-h-[500px]">
                        <!-- Columns will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Link Modal -->
    <div id="linkModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4">
            <h3 class="title-font text-xl font-bold mb-4"><i class="fas fa-link mr-2"></i>Adicionar Link</h3>
            <input type="text" id="linkName" placeholder="Nome do site" 
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition">
            <input type="url" id="linkUrl" placeholder="https://..." oninput="previewFavicon()"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition">
            <div id="faviconPreview" class="hidden items-center gap-2 mb-3 bg-white/10 rounded-lg p-3">
                <img id="faviconImg" src="" class="w-6 h-6 rounded">
                <span class="text-sm text-white/70">Favicon detectado</span>
            </div>
            <select id="linkFolder" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-4 outline-none cursor-pointer">
                <option value="">Sem pasta</option>
            </select>
            <div class="flex gap-3">
                <button onclick="closeLinkModal()" class="flex-1 bg-white/20 hover:bg-white/30 py-3 rounded-lg transition">Cancelar</button>
                <button onclick="addLink()" class="flex-1 bg-blue-500 hover:bg-blue-600 py-3 rounded-lg transition font-medium">Adicionar</button>
            </div>
        </div>
    </div>

    <!-- Add Folder Modal -->
    <div id="folderModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4">
            <h3 class="title-font text-xl font-bold mb-4"><i class="fas fa-folder-plus mr-2"></i>Nova Pasta</h3>
            <input type="text" id="folderName" placeholder="Nome da pasta" 
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-4 outline-none focus:border-white/40 transition">
            <div class="flex gap-3">
                <button onclick="closeFolderModal()" class="flex-1 bg-white/20 hover:bg-white/30 py-3 rounded-lg transition">Cancelar</button>
                <button onclick="addFolder()" class="flex-1 bg-blue-500 hover:bg-blue-600 py-3 rounded-lg transition font-medium">Criar</button>
            </div>
        </div>
    </div>

    <!-- Add Note Modal -->
    <div id="noteModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="title-font text-xl font-bold mb-4"><i class="fas fa-sticky-note mr-2"></i>Nova Tarefa</h3>
            <input type="text" id="noteTitle" placeholder="TÃ­tulo da tarefa" 
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition">
            <textarea id="noteContent" placeholder="DescriÃ§Ã£o..." rows="3"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition resize-none"></textarea>
            
            <!-- Column Selection -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Coluna:</p>
                <select id="noteColumn" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none cursor-pointer">
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            
            <!-- Category -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Categoria:</p>
                <select id="noteCategory" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none cursor-pointer">
                    <option value="outros">ðŸ“Œ Outros</option>
                    <option value="trabalho">ðŸ’¼ Trabalho</option>
                    <option value="pessoal">ðŸ  Pessoal</option>
                    <option value="estudos">ðŸ“š Estudos</option>
                    <option value="saude">â¤ï¸ SaÃºde</option>
                    <option value="financeiro">ðŸ’° Financeiro</option>
                </select>
            </div>
            
            <!-- Priority -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Prioridade:</p>
                <div class="flex gap-2">
                    <button type="button" onclick="selectPriority('low')" class="flex-1 py-2 rounded-lg transition priority-btn bg-white/10 hover:bg-green-500/50" data-priority="low">
                        ðŸŸ¢ Baixa
                    </button>
                    <button type="button" onclick="selectPriority('medium')" class="flex-1 py-2 rounded-lg transition priority-btn bg-white/10 hover:bg-yellow-500/50" data-priority="medium">
                        ðŸŸ¡ MÃ©dia
                    </button>
                    <button type="button" onclick="selectPriority('high')" class="flex-1 py-2 rounded-lg transition priority-btn bg-white/10 hover:bg-red-500/50" data-priority="high">
                        ðŸ”´ Alta
                    </button>
                </div>
            </div>
            
            <!-- Due Date -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Data de Vencimento:</p>
                <input type="date" id="noteDueDate" 
                    class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none focus:border-white/40 transition text-white">
            </div>
            
            <!-- Color -->
            <div class="mb-4">
                <p class="text-sm text-white/60 mb-2">Cor do post-it:</p>
                <div class="flex gap-2">
                    <button onclick="selectNoteColor('yellow')" class="w-8 h-8 rounded-full bg-yellow-300 border-2 border-transparent hover:border-white color-btn" data-color="yellow"></button>
                    <button onclick="selectNoteColor('pink')" class="w-8 h-8 rounded-full bg-pink-300 border-2 border-transparent hover:border-white color-btn" data-color="pink"></button>
                    <button onclick="selectNoteColor('blue')" class="w-8 h-8 rounded-full bg-blue-300 border-2 border-transparent hover:border-white color-btn" data-color="blue"></button>
                    <button onclick="selectNoteColor('green')" class="w-8 h-8 rounded-full bg-green-300 border-2 border-transparent hover:border-white color-btn" data-color="green"></button>
                    <button onclick="selectNoteColor('orange')" class="w-8 h-8 rounded-full bg-orange-300 border-2 border-transparent hover:border-white color-btn" data-color="orange"></button>
                    <button onclick="selectNoteColor('purple')" class="w-8 h-8 rounded-full bg-purple-300 border-2 border-transparent hover:border-white color-btn" data-color="purple"></button>
                </div>
            </div>
            <div class="flex gap-3">
                <button onclick="closeNoteModal()" class="flex-1 bg-white/20 hover:bg-white/30 py-3 rounded-lg transition">Cancelar</button>
                <button onclick="addNote()" class="flex-1 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 py-3 rounded-lg transition font-medium">Criar</button>
            </div>
        </div>
    </div>

    <!-- Add Column Modal -->
    <div id="columnModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4">
            <h3 class="title-font text-xl font-bold mb-4"><i class="fas fa-columns mr-2"></i>Nova Coluna</h3>
            <input type="text" id="columnName" placeholder="Nome da coluna (ex: Em RevisÃ£o)" 
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition">
            <div class="mb-4">
                <p class="text-sm text-white/60 mb-2">Cor da coluna:</p>
                <div class="flex gap-2 flex-wrap">
                    <button onclick="selectColumnColor('blue')" class="w-8 h-8 rounded-full bg-blue-500 border-2 border-transparent hover:border-white column-color-btn" data-color="blue"></button>
                    <button onclick="selectColumnColor('purple')" class="w-8 h-8 rounded-full bg-purple-500 border-2 border-transparent hover:border-white column-color-btn" data-color="purple"></button>
                    <button onclick="selectColumnColor('green')" class="w-8 h-8 rounded-full bg-green-500 border-2 border-transparent hover:border-white column-color-btn" data-color="green"></button>
                    <button onclick="selectColumnColor('yellow')" class="w-8 h-8 rounded-full bg-yellow-500 border-2 border-transparent hover:border-white column-color-btn" data-color="yellow"></button>
                    <button onclick="selectColumnColor('red')" class="w-8 h-8 rounded-full bg-red-500 border-2 border-transparent hover:border-white column-color-btn" data-color="red"></button>
                    <button onclick="selectColumnColor('pink')" class="w-8 h-8 rounded-full bg-pink-500 border-2 border-transparent hover:border-white column-color-btn" data-color="pink"></button>
                    <button onclick="selectColumnColor('cyan')" class="w-8 h-8 rounded-full bg-cyan-500 border-2 border-transparent hover:border-white column-color-btn" data-color="cyan"></button>
                    <button onclick="selectColumnColor('orange')" class="w-8 h-8 rounded-full bg-orange-500 border-2 border-transparent hover:border-white column-color-btn" data-color="orange"></button>
                </div>
            </div>
            <div class="flex gap-3">
                <button onclick="closeColumnModal()" class="flex-1 bg-white/20 hover:bg-white/30 py-3 rounded-lg transition">Cancelar</button>
                <button onclick="addColumn()" class="flex-1 bg-blue-500 hover:bg-blue-600 py-3 rounded-lg transition font-medium">Criar</button>
            </div>
        </div>
    </div>

    <!-- Edit Note Modal -->
    <div id="editNoteModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="title-font text-xl font-bold mb-4"><i class="fas fa-edit mr-2"></i>Editar Tarefa</h3>
            <input type="hidden" id="editNoteId">
            <input type="text" id="editNoteTitle" placeholder="TÃ­tulo da tarefa" 
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition">
            <textarea id="editNoteContent" placeholder="DescriÃ§Ã£o..." rows="3"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 mb-3 outline-none focus:border-white/40 transition resize-none"></textarea>
            
            <!-- Column Selection -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Coluna:</p>
                <select id="editNoteColumn" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none cursor-pointer">
                </select>
            </div>
            
            <!-- Category -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Categoria:</p>
                <select id="editNoteCategory" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none cursor-pointer">
                    <option value="outros">ðŸ“Œ Outros</option>
                    <option value="trabalho">ðŸ’¼ Trabalho</option>
                    <option value="pessoal">ðŸ  Pessoal</option>
                    <option value="estudos">ðŸ“š Estudos</option>
                    <option value="saude">â¤ï¸ SaÃºde</option>
                    <option value="financeiro">ðŸ’° Financeiro</option>
                </select>
            </div>
            
            <!-- Priority -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Prioridade:</p>
                <div class="flex gap-2">
                    <button type="button" onclick="selectEditPriority('low')" class="flex-1 py-2 rounded-lg transition edit-priority-btn bg-white/10 hover:bg-green-500/50" data-priority="low">
                        ðŸŸ¢ Baixa
                    </button>
                    <button type="button" onclick="selectEditPriority('medium')" class="flex-1 py-2 rounded-lg transition edit-priority-btn bg-white/10 hover:bg-yellow-500/50" data-priority="medium">
                        ðŸŸ¡ MÃ©dia
                    </button>
                    <button type="button" onclick="selectEditPriority('high')" class="flex-1 py-2 rounded-lg transition edit-priority-btn bg-white/10 hover:bg-red-500/50" data-priority="high">
                        ðŸ”´ Alta
                    </button>
                </div>
            </div>
            
            <!-- Due Date -->
            <div class="mb-3">
                <p class="text-sm text-white/60 mb-2">Data de Vencimento:</p>
                <input type="date" id="editNoteDueDate" 
                    class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none focus:border-white/40 transition text-white">
            </div>
            
            <!-- Color -->
            <div class="mb-4">
                <p class="text-sm text-white/60 mb-2">Cor do post-it:</p>
                <div class="flex gap-2">
                    <button onclick="selectEditNoteColor('yellow')" class="w-8 h-8 rounded-full bg-yellow-300 border-2 border-transparent hover:border-white edit-color-btn" data-color="yellow"></button>
                    <button onclick="selectEditNoteColor('pink')" class="w-8 h-8 rounded-full bg-pink-300 border-2 border-transparent hover:border-white edit-color-btn" data-color="pink"></button>
                    <button onclick="selectEditNoteColor('blue')" class="w-8 h-8 rounded-full bg-blue-300 border-2 border-transparent hover:border-white edit-color-btn" data-color="blue"></button>
                    <button onclick="selectEditNoteColor('green')" class="w-8 h-8 rounded-full bg-green-300 border-2 border-transparent hover:border-white edit-color-btn" data-color="green"></button>
                    <button onclick="selectEditNoteColor('orange')" class="w-8 h-8 rounded-full bg-orange-300 border-2 border-transparent hover:border-white edit-color-btn" data-color="orange"></button>
                    <button onclick="selectEditNoteColor('purple')" class="w-8 h-8 rounded-full bg-purple-300 border-2 border-transparent hover:border-white edit-color-btn" data-color="purple"></button>
                </div>
            </div>
            <div class="flex gap-3">
                <button onclick="closeEditNoteModal()" class="flex-1 bg-white/20 hover:bg-white/30 py-3 rounded-lg transition">Cancelar</button>
                <button onclick="saveEditedNote()" class="flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 py-3 rounded-lg transition font-medium">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="confirm-modal">
        <div class="confirm-modal-content">
            <div class="confirm-icon">
                <i class="fas fa-trash"></i>
            </div>
            <h3 class="confirm-title">Confirmar ExclusÃ£o</h3>
            <p class="confirm-message" id="confirmMessage">Tem certeza que deseja excluir este item?</p>
            <div class="confirm-buttons">
                <button class="confirm-btn confirm-btn-cancel" onclick="closeConfirmModal()">Cancelar</button>
                <button class="confirm-btn confirm-btn-confirm" id="confirmBtn" onclick="executeConfirmAction()">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Focus Mode Overlay -->
    <div id="focusModeOverlay" class="focus-mode-overlay">
        <svg class="focus-progress-ring">
            <circle cx="200" cy="200" r="180" stroke="rgba(34, 211, 238, 0.2)"/>
            <circle id="focusProgressCircle" cx="200" cy="200" r="180" stroke="#22d3ee" 
                stroke-dasharray="1131" stroke-dashoffset="0"/>
        </svg>
        <div class="focus-mode-content">
            <div id="focusTimer" class="focus-timer">25:00</div>
            <div id="focusTask" class="focus-task">
                <i class="fas fa-bullseye mr-2"></i>
                <span>Foco total!</span>
            </div>
            <div class="focus-message">Mantenha o foco. VocÃª consegue! ðŸ’ª</div>
            <div class="focus-controls">
                <button class="focus-btn focus-btn-pause" onclick="pausePomodoro()">
                    <i class="fas fa-pause mr-2"></i>Pausar
                </button>
                <button class="focus-btn focus-btn-stop" onclick="exitFocusMode()">
                    <i class="fas fa-times mr-2"></i>Sair do Foco
                </button>
            </div>
        </div>
        <div class="focus-breathing">
            <div class="breathing-circle"></div>
            <span>Respire...</span>
        </div>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcutsModal" class="shortcuts-modal" onclick="if(event.target === this) closeShortcutsModal()">
        <div class="shortcuts-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="title-font text-xl font-bold"><i class="fas fa-keyboard mr-2"></i>Atalhos de Teclado</h3>
                <button onclick="closeShortcutsModal()" class="text-white/60 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="space-y-1">
                <div class="shortcut-item">
                    <span>Nova Tarefa</span>
                    <span class="shortcut-key"><kbd>N</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Pesquisar</span>
                    <span class="shortcut-key"><kbd>Ctrl</kbd> + <kbd>K</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Iniciar/Pausar Pomodoro</span>
                    <span class="shortcut-key"><kbd>EspaÃ§o</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Modo Foco</span>
                    <span class="shortcut-key"><kbd>F</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Adicionar Ãgua</span>
                    <span class="shortcut-key"><kbd>W</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Exportar Dados</span>
                    <span class="shortcut-key"><kbd>Ctrl</kbd> + <kbd>S</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Mostrar Atalhos</span>
                    <span class="shortcut-key"><kbd>?</kbd></span>
                </div>
                <div class="shortcut-item">
                    <span>Fechar Modal</span>
                    <span class="shortcut-key"><kbd>Esc</kbd></span>
                </div>
            </div>
            <p class="text-white/40 text-sm mt-6 text-center">
                Pressione <kbd class="bg-white/10 px-2 py-1 rounded">?</kbd> a qualquer momento para ver esta ajuda
            </p>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="title-font text-xl font-bold"><i class="fas fa-cog mr-2"></i>ConfiguraÃ§Ãµes</h3>
                <button onclick="closeSettingsModal()" class="text-white/60 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- User Name -->
            <div class="mb-6">
                <label class="block text-sm text-white/60 mb-2"><i class="fas fa-user mr-2"></i>Seu Nome</label>
                <input type="text" id="settingsUserName" placeholder="Digite seu nome" 
                    class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 outline-none focus:border-white/40 transition">
            </div>
            
            <!-- Theme -->
            <div class="mb-6">
                <label class="block text-sm text-white/60 mb-2"><i class="fas fa-moon mr-2"></i>Tema</label>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="setTheme('dark')" id="themeDarkBtn" class="theme-btn p-4 rounded-xl bg-gray-900 border-2 border-transparent hover:border-white/30 transition flex flex-col items-center gap-2">
                        <i class="fas fa-moon text-2xl"></i>
                        <span class="text-sm">Escuro</span>
                    </button>
                    <button onclick="setTheme('light')" id="themeLightBtn" class="theme-btn p-4 rounded-xl bg-gray-100 text-gray-800 border-2 border-transparent hover:border-white/30 transition flex flex-col items-center gap-2">
                        <i class="fas fa-sun text-2xl"></i>
                        <span class="text-sm">Claro</span>
                    </button>
                </div>
            </div>
            
            <!-- Accent Color -->
            <div class="mb-6">
                <label class="block text-sm text-white/60 mb-2"><i class="fas fa-palette mr-2"></i>Cor de Destaque</label>
                <div class="flex gap-3 flex-wrap">
                    <button onclick="setAccentColor('cyan')" class="accent-btn w-10 h-10 rounded-full bg-cyan-500 border-2 border-transparent hover:scale-110 transition" data-color="cyan"></button>
                    <button onclick="setAccentColor('blue')" class="accent-btn w-10 h-10 rounded-full bg-blue-500 border-2 border-transparent hover:scale-110 transition" data-color="blue"></button>
                    <button onclick="setAccentColor('purple')" class="accent-btn w-10 h-10 rounded-full bg-purple-500 border-2 border-transparent hover:scale-110 transition" data-color="purple"></button>
                    <button onclick="setAccentColor('pink')" class="accent-btn w-10 h-10 rounded-full bg-pink-500 border-2 border-transparent hover:scale-110 transition" data-color="pink"></button>
                    <button onclick="setAccentColor('green')" class="accent-btn w-10 h-10 rounded-full bg-green-500 border-2 border-transparent hover:scale-110 transition" data-color="green"></button>
                    <button onclick="setAccentColor('orange')" class="accent-btn w-10 h-10 rounded-full bg-orange-500 border-2 border-transparent hover:scale-110 transition" data-color="orange"></button>
                    <button onclick="setAccentColor('red')" class="accent-btn w-10 h-10 rounded-full bg-red-500 border-2 border-transparent hover:scale-110 transition" data-color="red"></button>
                </div>
            </div>
            
            <!-- Focus Mode Settings -->
            <div class="mb-6">
                <label class="block text-sm text-white/60 mb-2"><i class="fas fa-bullseye mr-2"></i>Modo Foco</label>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input type="checkbox" id="autoFocusModeToggle" class="w-5 h-5 rounded" onchange="toggleAutoFocusMode()">
                    <span class="text-sm">Ativar automaticamente com Pomodoro</span>
                </label>
            </div>
            
            <!-- Water Reminder Settings -->
            <div class="mb-6">
                <label class="block text-sm text-white/60 mb-2"><i class="fas fa-tint mr-2"></i>Lembretes de Ãgua</label>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input type="checkbox" id="waterReminderToggle" class="w-5 h-5 rounded" onchange="toggleWaterReminders()">
                    <span class="text-sm">Lembrar a cada 1 hora</span>
                </label>
            </div>
            
            <!-- Save Button -->
            <button onclick="saveSettings()" class="w-full bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 py-3 rounded-xl transition font-medium">
                <i class="fas fa-save mr-2"></i>Salvar ConfiguraÃ§Ãµes
            </button>
        </div>
    </div>

    <!-- Water Reminder Popup -->
    <div id="waterReminderPopup" class="water-reminder-popup">
        <span class="water-icon">ðŸ’§</span>
        <div>
            <div class="font-semibold">Hora de beber Ã¡gua!</div>
            <div class="text-sm opacity-80">Mantenha-se hidratado</div>
        </div>
        <button onclick="addWater(1); hideWaterReminder()">
            <i class="fas fa-plus mr-1"></i>Bebi!
        </button>
        <button onclick="hideWaterReminder()">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Weather Forecast Modal -->
    <div id="forecastModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="title-font text-xl font-bold"><i class="fas fa-calendar-week mr-2 text-blue-400"></i>PrevisÃ£o 5 Dias</h3>
                <button onclick="closeForecastModal()" class="text-white/60 hover:text-white transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- Location -->
            <div class="flex items-center gap-2 mb-4 text-white/60">
                <i class="fas fa-map-marker-alt"></i>
                <span>ItatiaiuÃ§u, MG</span>
            </div>
            
            <!-- Forecast Loading -->
            <div id="forecastLoading" class="text-center py-8">
                <i class="fas fa-spinner fa-spin text-3xl text-white/50 mb-4"></i>
                <p class="text-white/50">Carregando previsÃ£o...</p>
            </div>
            
            <!-- Forecast Error -->
            <div id="forecastError" class="hidden text-center py-8">
                <i class="fas fa-exclamation-triangle text-3xl text-yellow-400 mb-4"></i>
                <p class="text-white/70 mb-4">NÃ£o foi possÃ­vel carregar a previsÃ£o</p>
                <button onclick="fetchForecast()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm transition">
                    <i class="fas fa-redo mr-2"></i>Tentar novamente
                </button>
            </div>
            
            <!-- Forecast Content -->
            <div id="forecastContent" class="hidden">
                <!-- Today Summary -->
                <div id="forecastToday" class="bg-white/10 rounded-xl p-4 mb-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-lg">Hoje</h4>
                            <p id="forecastTodayDesc" class="text-white/70 text-sm"></p>
                        </div>
                        <div class="text-right">
                            <div id="forecastTodayTemp" class="text-3xl font-bold title-font"></div>
                            <div id="forecastTodayMinMax" class="text-xs text-white/50"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 5 Day Forecast -->
                <div id="forecastDays" class="space-y-2">
                    <!-- Days will be populated by JS -->
                </div>
                
                <!-- Additional Info -->
                <div class="mt-4 grid grid-cols-2 gap-3">
                    <div class="bg-white/10 rounded-lg p-3 text-center">
                        <i class="fas fa-sun text-yellow-400 mb-1"></i>
                        <div class="text-xs text-white/50">Nascer do Sol</div>
                        <div id="forecastSunrise" class="font-semibold">--:--</div>
                    </div>
                    <div class="bg-white/10 rounded-lg p-3 text-center">
                        <i class="fas fa-moon text-blue-300 mb-1"></i>
                        <div class="text-xs text-white/50">PÃ´r do Sol</div>
                        <div id="forecastSunset" class="font-semibold">--:--</div>
                    </div>
                </div>
                
                <!-- Last Update -->
                <div id="forecastLastUpdate" class="text-center text-[10px] text-white/30 mt-4"></div>
            </div>
        </div>
    </div>

    <!-- Mood Report Modal -->
    <div id="moodReportModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="title-font text-xl font-bold"><i class="fas fa-chart-line mr-2 text-pink-400"></i>RelatÃ³rio de Humor</h3>
                <button onclick="closeMoodReportModal()" class="text-white/60 hover:text-white transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- Period Selector -->
            <div class="flex gap-2 mb-6">
                <button onclick="setReportPeriod(7)" class="report-period-btn flex-1 py-2 rounded-lg bg-pink-500/30 text-sm font-medium transition" data-period="7">
                    7 dias
                </button>
                <button onclick="setReportPeriod(14)" class="report-period-btn flex-1 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm font-medium transition" data-period="14">
                    14 dias
                </button>
                <button onclick="setReportPeriod(30)" class="report-period-btn flex-1 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm font-medium transition" data-period="30">
                    30 dias
                </button>
            </div>
            
            <!-- Summary Cards -->
            <div class="grid grid-cols-3 gap-3 mb-6">
                <div class="bg-white/10 rounded-xl p-3 text-center">
                    <div id="reportAvgEmoji" class="text-3xl mb-1">ðŸ˜Š</div>
                    <div class="text-xs text-white/50">MÃ©dia</div>
                    <div id="reportAvgText" class="text-sm font-semibold">Bom</div>
                </div>
                <div class="bg-white/10 rounded-xl p-3 text-center">
                    <div id="reportBestEmoji" class="text-3xl mb-1">ðŸ¤©</div>
                    <div class="text-xs text-white/50">Melhor Dia</div>
                    <div id="reportBestDay" class="text-sm font-semibold">--</div>
                </div>
                <div class="bg-white/10 rounded-xl p-3 text-center">
                    <div id="reportWorstEmoji" class="text-3xl mb-1">ðŸ˜</div>
                    <div class="text-xs text-white/50">Pior Dia</div>
                    <div id="reportWorstDay" class="text-sm font-semibold">--</div>
                </div>
            </div>
            
            <!-- Mood Chart -->
            <div class="bg-white/5 rounded-xl p-4 mb-6">
                <h4 class="text-sm font-semibold mb-4 text-white/70"><i class="fas fa-chart-bar mr-2"></i>GrÃ¡fico de Humor</h4>
                <div id="moodChart" class="flex items-end justify-between gap-1 h-32">
                    <!-- Chart bars will be populated by JS -->
                </div>
                <div id="moodChartLabels" class="flex justify-between mt-2 text-[10px] text-white/40">
                    <!-- Labels will be populated by JS -->
                </div>
            </div>
            
            <!-- Mood Distribution -->
            <div class="bg-white/5 rounded-xl p-4 mb-6">
                <h4 class="text-sm font-semibold mb-4 text-white/70"><i class="fas fa-pie-chart mr-2"></i>DistribuiÃ§Ã£o</h4>
                <div id="moodDistribution" class="space-y-2">
                    <!-- Distribution bars will be populated by JS -->
                </div>
            </div>
            
            <!-- Trend & Insights -->
            <div class="bg-white/5 rounded-xl p-4 mb-6">
                <h4 class="text-sm font-semibold mb-3 text-white/70"><i class="fas fa-lightbulb mr-2"></i>Insights</h4>
                <div id="moodInsights" class="space-y-2 text-sm">
                    <!-- Insights will be populated by JS -->
                </div>
            </div>
            
            <!-- Statistics -->
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="bg-white/10 rounded-lg p-3">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-calendar-check text-green-400"></i>
                        <span class="text-xs text-white/50">Dias registrados</span>
                    </div>
                    <div id="reportDaysLogged" class="text-xl font-bold mt-1">0</div>
                </div>
                <div class="bg-white/10 rounded-lg p-3">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-fire text-orange-400"></i>
                        <span class="text-xs text-white/50">SequÃªncia atual</span>
                    </div>
                    <div id="reportStreak" class="text-xl font-bold mt-1">0 dias</div>
                </div>
            </div>
            
            <!-- Notes Section -->
            <div class="bg-white/5 rounded-xl p-4">
                <h4 class="text-sm font-semibold mb-3 text-white/70"><i class="fas fa-sticky-note mr-2"></i>Notas Recentes</h4>
                <div id="moodNotes" class="space-y-2 max-h-32 overflow-y-auto text-sm">
                    <!-- Notes will be populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== DATA STORAGE =====
        let links = JSON.parse(localStorage.getItem('dashboardLinks')) || [
            { name: 'Google', url: 'https://google.com', icon: 'fab fa-google', folder: '' },
            { name: 'YouTube', url: 'https://youtube.com', icon: 'fab fa-youtube', folder: '' },
            { name: 'GitHub', url: 'https://github.com', icon: 'fab fa-github', folder: '' },
            { name: 'Gmail', url: 'https://gmail.com', icon: 'fas fa-envelope', folder: '' },
            { name: 'Twitter', url: 'https://twitter.com', icon: 'fab fa-twitter', folder: '' },
            { name: 'LinkedIn', url: 'https://linkedin.com', icon: 'fab fa-linkedin', folder: '' },
            { name: 'Netflix', url: 'https://netflix.com', icon: 'fas fa-film', folder: '' },
            { name: 'Spotify', url: 'https://spotify.com', icon: 'fab fa-spotify', folder: '' },
            { name: 'WhatsApp', url: 'https://web.whatsapp.com', icon: 'fab fa-whatsapp', folder: '' }
        ];

        let folders = JSON.parse(localStorage.getItem('dashboardFolders')) || [];
        let notes = JSON.parse(localStorage.getItem('dashboardNotes')) || [];
        let columns = JSON.parse(localStorage.getItem('kanbanColumns')) || [
            { id: 'todo', name: 'A Fazer', color: 'blue' },
            { id: 'doing', name: 'Em Progresso', color: 'yellow' },
            { id: 'done', name: 'ConcluÃ­do', color: 'green' }
        ];
        let selectedNoteColor = 'yellow';
        let selectedPriority = 'medium';
        let selectedColumnColor = 'blue';
        let linksExpanded = false;
        let draggedElement = null;
        let draggedIndex = null;
        let draggedCard = null;
        let draggedCardId = null;
        let draggedColumnId = null;

        // ===== MOTIVATIONAL QUOTES =====
        const quotes = [
            { text: "O sucesso Ã© a soma de pequenos esforÃ§os repetidos dia apÃ³s dia.", author: "Robert Collier" },
            { text: "A Ãºnica maneira de fazer um excelente trabalho Ã© amar o que vocÃª faz.", author: "Steve Jobs" },
            { text: "Acredite que vocÃª pode, assim vocÃª jÃ¡ estÃ¡ no meio do caminho.", author: "Theodore Roosevelt" },
            { text: "O futuro pertence Ã queles que acreditam na beleza de seus sonhos.", author: "Eleanor Roosevelt" },
            { text: "NÃ£o espere por oportunidades, crie-as.", author: "George Bernard Shaw" },
            { text: "A persistÃªncia Ã© o caminho do Ãªxito.", author: "Charles Chaplin" },
            { text: "Grandes realizaÃ§Ãµes sÃ£o possÃ­veis quando se dÃ¡ importÃ¢ncia aos pequenos comeÃ§os.", author: "Lao TsÃ©" },
            { text: "O Ãºnico modo de fazer um Ã³timo trabalho Ã© amando o que vocÃª faz.", author: "Steve Jobs" },
            { text: "VocÃª Ã© mais corajoso do que acredita, mais forte do que parece e mais inteligente do que pensa.", author: "A.A. Milne" },
            { text: "A vida Ã© 10% o que acontece comigo e 90% como eu reajo a isso.", author: "Charles Swindoll" },
            { text: "Tudo o que vocÃª sempre quis estÃ¡ do outro lado do medo.", author: "George Addair" },
            { text: "Comece de onde vocÃª estÃ¡. Use o que vocÃª tem. FaÃ§a o que vocÃª pode.", author: "Arthur Ashe" },
            { text: "O segredo de progredir Ã© comeÃ§ar.", author: "Mark Twain" },
            { text: "Cada dia Ã© uma nova chance de mudar sua vida.", author: "Desconhecido" },
            { text: "Foco na jornada, nÃ£o no destino. A alegria nÃ£o estÃ¡ em terminar, mas em fazer.", author: "Greg Anderson" }
        ];

        function showRandomQuote() {
            const quote = quotes[Math.floor(Math.random() * quotes.length)];
            const quoteText = document.getElementById('quoteText');
            const quoteAuthor = document.getElementById('quoteAuthor');
            
            quoteText.classList.remove('quote-fade');
            void quoteText.offsetWidth;
            quoteText.classList.add('quote-fade');
            
            quoteText.textContent = `"${quote.text}"`;
            quoteAuthor.textContent = `â€” ${quote.author}`;
        }

        // ===== SPLASH SCREEN =====
        function showSplashScreen() {
            const hour = new Date().getHours();
            let greeting = 'Boa noite,';
            if (hour >= 5 && hour < 12) greeting = 'Bom dia,';
            else if (hour >= 12 && hour < 18) greeting = 'Boa tarde,';
            
            document.getElementById('splashGreeting').textContent = greeting;
            
            // Animate loader percentage
            const percentageEl = document.getElementById('loaderPercentage');
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                }
                percentageEl.textContent = Math.floor(progress) + '%';
            }, 200);
            
            // Fade out after animation
            setTimeout(() => {
                document.getElementById('splashScreen').classList.add('fade-out');
                document.getElementById('mainContent').classList.add('visible');
            }, 4500);
        }

        // ===== PARALLAX EFFECT =====
        function initParallax() {
            const parallaxBg = document.getElementById('parallaxBg');
            let currentX = 0;
            let currentY = 0;
            let targetX = 0;
            let targetY = 0;
            
            // Efeito suave de parallax com o mouse (muito sutil para nÃ£o quebrar o fundo)
            window.addEventListener('mousemove', (e) => {
                targetX = (e.clientX - window.innerWidth / 2) * 0.005;
                targetY = (e.clientY - window.innerHeight / 2) * 0.005;
            });
            
            // AnimaÃ§Ã£o suave
            function animateParallax() {
                currentX += (targetX - currentX) * 0.05;
                currentY += (targetY - currentY) * 0.05;
                parallaxBg.style.transform = `translate(${currentX}px, ${currentY}px) scale(1.02)`;
                requestAnimationFrame(animateParallax);
            }
            
            animateParallax();
        }

        // ===== POMODORO VARIABLES =====
        let pomodoroTime = 25 * 60;
        let pomodoroInitialTime = 25 * 60;
        let pomodoroInterval = null;
        let pomodoroRunning = false;
        let pomodoroSessions = parseInt(localStorage.getItem('pomodoroSessions')) || 0;
        let isBreak = false;

        // ===== WATER TRACKER VARIABLES =====
        let waterCount = parseInt(localStorage.getItem('waterCount')) || 0;
        let waterGoal = parseInt(localStorage.getItem('waterGoal')) || 8;
        let waterDate = localStorage.getItem('waterDate') || '';

        // ===== MOOD TRACKER VARIABLES =====
        let moodHistory = JSON.parse(localStorage.getItem('moodHistory')) || [];
        const moodEmojis = {
            terrible: 'ðŸ˜¢',
            bad: 'ðŸ˜”',
            okay: 'ðŸ˜',
            good: 'ðŸ˜Š',
            great: 'ðŸ¤©'
        };
        const moodTexts = {
            terrible: 'Dia difÃ­cil... ðŸ’™',
            bad: 'NÃ£o estÃ¡ fÃ¡cil, mas vai passar!',
            okay: 'Um dia normal',
            good: 'Dia bom! Continue assim!',
            great: 'Dia incrÃ­vel! ðŸŽ‰'
        };

        // ===== BACKGROUND IMAGES =====
        const backgrounds = {
            morning: {
                clear: 'https://images.unsplash.com/photo-1470252649378-9c29740c9fa8?w=1920',
                clouds: 'https://images.unsplash.com/photo-1534088568595-a066f410bcda?w=1920',
                rain: 'https://images.unsplash.com/photo-1428592953211-077101b2021b?w=1920',
                storm: 'https://images.unsplash.com/photo-1605727216801-e27ce1d0cc28?w=1920'
            },
            afternoon: {
                clear: 'https://images.unsplash.com/photo-1517483000871-1dbf64a6e1c6?w=1920',
                clouds: 'https://images.unsplash.com/photo-1534088568595-a066f410bcda?w=1920',
                rain: 'https://images.unsplash.com/photo-1433863448220-78aaa064ff47?w=1920',
                storm: 'https://images.unsplash.com/photo-1605727216801-e27ce1d0cc28?w=1920'
            },
            evening: {
                clear: 'https://images.unsplash.com/photo-1495344517868-8ebaf0a2044a?w=1920',
                clouds: 'https://images.unsplash.com/photo-1485470733090-0aae1788d5af?w=1920',
                rain: 'https://images.unsplash.com/photo-1501691223387-dd0500403074?w=1920',
                storm: 'https://images.unsplash.com/photo-1605727216801-e27ce1d0cc28?w=1920'
            },
            night: {
                clear: 'https://images.unsplash.com/photo-1507400492013-162706c8c05e?w=1920',
                clouds: 'https://images.unsplash.com/photo-1505506874110-6a7a69069a08?w=1920',
                rain: 'https://images.unsplash.com/photo-1501691223387-dd0500403074?w=1920',
                storm: 'https://images.unsplash.com/photo-1605727216801-e27ce1d0cc28?w=1920'
            }
        };

        // ===== CLOCK & DATE =====
        function updateClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            document.getElementById('clock').textContent = `${hours}:${minutes}`;
            document.getElementById('seconds').textContent = seconds;
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('date').textContent = now.toLocaleDateString('pt-BR', options);
        }

        // ===== WEATHER =====
        let currentWeather = 'clear';
        let weatherCache = JSON.parse(localStorage.getItem('weatherCache')) || null;
        let isWeatherLoading = false;
        
        async function fetchWeather() {
            // Prevent multiple simultaneous requests
            if (isWeatherLoading) {
                console.log('[Clima] JÃ¡ estÃ¡ carregando, ignorando...');
                return;
            }
            
            isWeatherLoading = true;
            console.log('[Clima] Iniciando busca de dados...');
            
            const loadingEl = document.getElementById('weatherLoading');
            const errorEl = document.getElementById('weatherError');
            const contentEl = document.getElementById('weatherContent');
            const refreshBtn = document.getElementById('weatherRefreshBtn');
            const lastUpdateEl = document.getElementById('weatherLastUpdate');
            
            // Show loading state
            loadingEl?.classList.remove('hidden');
            errorEl?.classList.add('hidden');
            contentEl?.classList.add('hidden');
            
            try {
                // Create AbortController for timeout
                const controller = new AbortController();
                const timeoutId = setTimeout(() => {
                    controller.abort();
                    console.log('[Clima] Timeout apÃ³s 10 segundos');
                }, 10000); // 10 second timeout
                
                console.log('[Clima] Fazendo requisiÃ§Ã£o para API...');
                const response = await fetch(
                    'https://api.open-meteo.com/v1/forecast?latitude=-20.2&longitude=-44.4&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m&timezone=America/Sao_Paulo',
                    { signal: controller.signal }
                );
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('[Clima] Dados recebidos:', data);
                
                if (!data.current) {
                    throw new Error('Dados invÃ¡lidos recebidos da API');
                }
                
                const temp = Math.round(data.current.temperature_2m);
                const humidity = data.current.relative_humidity_2m;
                const windSpeed = Math.round(data.current.wind_speed_10m);
                const weatherCode = data.current.weather_code;
                
                // Save to cache
                weatherCache = {
                    temp,
                    humidity,
                    windSpeed,
                    weatherCode,
                    timestamp: Date.now()
                };
                localStorage.setItem('weatherCache', JSON.stringify(weatherCache));
                console.log('[Clima] Dados salvos no cache');
                
                // Update UI
                updateWeatherUI(temp, humidity, windSpeed, weatherCode);
                
                // Show success state
                loadingEl?.classList.add('hidden');
                errorEl?.classList.add('hidden');
                contentEl?.classList.remove('hidden');
                refreshBtn?.classList.add('hidden');
                
                // Show last update time
                if (lastUpdateEl) {
                    lastUpdateEl.textContent = `Atualizado: ${new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
                }
                
                console.log('[Clima] âœ… Dados carregados com sucesso');
                
            } catch (error) {
                console.error('[Clima] âŒ Erro:', error.message);
                
                // Try to use cache
                if (weatherCache && weatherCache.temp !== undefined) {
                    console.log('[Clima] Usando dados do cache...');
                    updateWeatherUI(weatherCache.temp, weatherCache.humidity, weatherCache.windSpeed, weatherCache.weatherCode);
                    
                    loadingEl?.classList.add('hidden');
                    errorEl?.classList.add('hidden');
                    contentEl?.classList.remove('hidden');
                    refreshBtn?.classList.remove('hidden');
                    
                    const cacheAge = Math.round((Date.now() - weatherCache.timestamp) / 60000);
                    if (lastUpdateEl) {
                        lastUpdateEl.textContent = `Dados em cache (${cacheAge} min atrÃ¡s)`;
                    }
                    
                    showToast('warning', 'Usando cache', 'NÃ£o foi possÃ­vel atualizar o clima, mostrando dados salvos');
                } else {
                    // Show error state
                    loadingEl?.classList.add('hidden');
                    errorEl?.classList.remove('hidden');
                    contentEl?.classList.add('hidden');
                    
                    const errorDetails = document.getElementById('weatherErrorDetails');
                    if (errorDetails) {
                        let errorMsg = error.message;
                        if (error.name === 'AbortError') {
                            errorMsg = 'Tempo limite excedido (10s)';
                        } else if (error.message.includes('Failed to fetch')) {
                            errorMsg = 'Sem conexÃ£o com a internet';
                        }
                        errorDetails.textContent = errorMsg;
                    }
                }
                
                updateBackground();
            } finally {
                isWeatherLoading = false;
            }
        }
        
        function updateWeatherUI(temp, humidity, windSpeed, weatherCode) {
            document.getElementById('temperature').textContent = `${temp}Â°C`;
            document.getElementById('humidity').textContent = `${humidity}%`;
            document.getElementById('wind').textContent = `${windSpeed} km/h`;
            
            const weatherInfo = getWeatherInfo(weatherCode);
            document.getElementById('weatherIconContainer').innerHTML = weatherInfo.iconHtml;
            document.getElementById('weatherDesc').textContent = weatherInfo.desc;
            currentWeather = weatherInfo.type;
            
            updateBackground();
        }
        
        function initWeather() {
            console.log('[Clima] Inicializando...');
            
            const loadingEl = document.getElementById('weatherLoading');
            const errorEl = document.getElementById('weatherError');
            const contentEl = document.getElementById('weatherContent');
            const lastUpdateEl = document.getElementById('weatherLastUpdate');
            
            // If we have cache, show it immediately
            if (weatherCache && weatherCache.temp !== undefined) {
                const cacheAge = (Date.now() - weatherCache.timestamp) / 60000; // in minutes
                console.log(`[Clima] Cache encontrado (${cacheAge.toFixed(1)} min atrÃ¡s)`);
                
                // If cache is less than 30 minutes old, show it
                if (cacheAge < 30) {
                    updateWeatherUI(weatherCache.temp, weatherCache.humidity, weatherCache.windSpeed, weatherCache.weatherCode);
                    
                    loadingEl?.classList.add('hidden');
                    errorEl?.classList.add('hidden');
                    contentEl?.classList.remove('hidden');
                    
                    if (lastUpdateEl) {
                        lastUpdateEl.textContent = `Cache: ${Math.round(cacheAge)} min atrÃ¡s`;
                    }
                }
            }
            
            // Fetch fresh data in background
            fetchWeather();
        }

        function getWeatherInfo(code) {
            const hour = new Date().getHours();
            const isNight = hour < 6 || hour >= 20;
            
            if (code === 0) {
                return { 
                    iconHtml: isNight ? getWeatherIconHtml('night') : getWeatherIconHtml('clear'), 
                    desc: isNight ? 'Noite limpa' : 'CÃ©u limpo', 
                    type: 'clear' 
                };
            }
            if (code <= 3) return { iconHtml: getWeatherIconHtml('partly-cloudy'), desc: 'Parcialmente nublado', type: 'clouds' };
            if (code <= 48) return { iconHtml: getWeatherIconHtml('cloudy'), desc: 'Nublado', type: 'clouds' };
            if (code <= 49) return { iconHtml: getWeatherIconHtml('mist'), desc: 'Neblina', type: 'clouds' };
            if (code <= 69) return { iconHtml: getWeatherIconHtml('rain'), desc: 'Chuva', type: 'rain' };
            if (code <= 79) return { iconHtml: getWeatherIconHtml('snow'), desc: 'Neve', type: 'rain' };
            if (code <= 82) return { iconHtml: getWeatherIconHtml('rain'), desc: 'Pancadas de chuva', type: 'rain' };
            if (code <= 99) return { iconHtml: getWeatherIconHtml('storm'), desc: 'Tempestade', type: 'storm' };
            return { iconHtml: getWeatherIconHtml('clear'), desc: 'CÃ©u limpo', type: 'clear' };
        }

        function getWeatherIconHtml(type) {
            const icons = {
                'clear': `<div class="weather-sun">
                    <div class="sun-rays"></div>
                    <div class="sun-core"></div>
                </div>`,
                'night': `<div class="weather-night">
                    <div class="stars">
                        <div class="star"></div>
                        <div class="star"></div>
                        <div class="star"></div>
                        <div class="star"></div>
                        <div class="star"></div>
                    </div>
                    <div class="moon">
                        <div class="moon-inner"></div>
                    </div>
                </div>`,
                'partly-cloudy': `<div class="weather-partly-cloudy">
                    <div class="weather-sun">
                        <div class="sun-rays"></div>
                        <div class="sun-core"></div>
                    </div>
                    <div class="weather-cloud">
                        <div class="cloud-scan"></div>
                    </div>
                </div>`,
                'cloudy': `<div class="weather-cloudy">
                    <div class="cloud-back"></div>
                    <div class="weather-cloud">
                        <div class="cloud-scan"></div>
                    </div>
                </div>`,
                'rain': `<div class="weather-rain">
                    <div class="weather-cloud"></div>
                    <div class="rain-drops">
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                    </div>
                </div>`,
                'storm': `<div class="weather-storm">
                    <div class="weather-cloud"></div>
                    <div class="lightning"></div>
                    <div class="rain-drops">
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                        <div class="drop"></div>
                    </div>
                </div>`,
                'snow': `<div class="weather-snow">
                    <div class="weather-cloud"></div>
                    <div class="snowflakes">
                        <div class="flake"></div>
                        <div class="flake"></div>
                        <div class="flake"></div>
                        <div class="flake"></div>
                        <div class="flake"></div>
                        <div class="flake"></div>
                    </div>
                </div>`,
                'mist': `<div class="weather-mist">
                    <div class="fog-circle"></div>
                    <div class="fog-line"></div>
                    <div class="fog-line"></div>
                    <div class="fog-line"></div>
                    <div class="fog-line"></div>
                </div>`
            };
            return icons[type] || icons['clear'];
        }

        function getTimeOfDay() {
            const hour = new Date().getHours();
            if (hour >= 5 && hour < 12) return 'morning';
            if (hour >= 12 && hour < 17) return 'afternoon';
            if (hour >= 17 && hour < 20) return 'evening';
            return 'night';
        }

        function updateBackground() {
            const timeOfDay = getTimeOfDay();
            const bgUrl = backgrounds[timeOfDay][currentWeather] || backgrounds[timeOfDay].clear;
            document.getElementById('parallaxBg').style.backgroundImage = `url('${bgUrl}')`;
        }

        // ===== SEARCH =====
        function search() {
            const query = document.getElementById('searchInput').value.trim();
            if (query) {
                window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
            }
        }

        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') search();
        });

        // ===== FAVICON =====
        function getFaviconUrl(url) {
            try {
                const domain = new URL(url).hostname;
                return `https://www.google.com/s2/favicons?domain=${domain}&sz=64`;
            } catch {
                return null;
            }
        }

        function previewFavicon() {
            const url = document.getElementById('linkUrl').value;
            const faviconUrl = getFaviconUrl(url);
            const preview = document.getElementById('faviconPreview');
            const img = document.getElementById('faviconImg');
            
            if (faviconUrl) {
                img.src = faviconUrl;
                preview.classList.remove('hidden');
                preview.classList.add('flex');
            } else {
                preview.classList.add('hidden');
                preview.classList.remove('flex');
            }
        }

        // ===== LINKS =====
        function renderLinks() {
            const container = document.getElementById('linksGrid');
            const folderFilter = document.getElementById('linkFolderFilter').value;
            
            let filteredLinks = links;
            if (folderFilter !== 'all') {
                filteredLinks = links.filter(link => link.folder === folderFilter);
            }
            
            container.innerHTML = filteredLinks.map((link, index) => {
                const originalIndex = links.indexOf(link);
                const faviconUrl = getFaviconUrl(link.url);
                return `
                    <a href="${link.url}" target="_blank" class="link-item glass rounded-xl p-3 text-center group relative"
                        draggable="true" ondragstart="dragLinkStart(event, ${originalIndex})" ondragend="dragLinkEnd(event)"
                        ondragover="dragLinkOver(event)" ondrop="dropLink(event, ${originalIndex})">
                        <img src="${faviconUrl}" class="w-6 h-6 mx-auto mb-1 rounded" onerror="this.style.display='none';">
                        <span class="text-xs truncate block">${link.name}</span>
                        ${link.folder ? `<span class="text-[10px] text-white/40 block truncate">ðŸ“ ${link.folder}</span>` : ''}
                        <button onclick="event.preventDefault(); deleteLink(${originalIndex})" 
                            class="absolute -top-2 -right-2 bg-red-500 w-5 h-5 rounded-full text-xs opacity-0 group-hover:opacity-100 transition">
                            <i class="fas fa-times"></i>
                        </button>
                    </a>
                `;
            }).join('');
            
            updateFolderOptions();
            saveLinks();
        }

        function updateFolderOptions() {
            const filterSelect = document.getElementById('linkFolderFilter');
            const linkFolderSelect = document.getElementById('linkFolder');
            
            // Update filter
            filterSelect.innerHTML = '<option value="all">Todas Pastas</option>' + 
                folders.map(f => `<option value="${f}">${f}</option>`).join('');
            
            // Update add link modal
            linkFolderSelect.innerHTML = '<option value="">Sem pasta</option>' + 
                folders.map(f => `<option value="${f}">${f}</option>`).join('');
        }

        function filterLinksByFolder() {
            renderLinks();
        }

        // Link Drag & Drop
        function dragLinkStart(e, index) {
            draggedIndex = index;
            e.target.classList.add('dragging');
        }

        function dragLinkEnd(e) {
            e.target.classList.remove('dragging');
        }

        function dragLinkOver(e) {
            e.preventDefault();
        }

        function dropLink(e, targetIndex) {
            e.preventDefault();
            if (draggedIndex !== null && draggedIndex !== targetIndex) {
                const draggedItem = links[draggedIndex];
                links.splice(draggedIndex, 1);
                links.splice(targetIndex, 0, draggedItem);
                renderLinks();
            }
            draggedIndex = null;
        }

        function toggleLinks() {
            const grid = document.getElementById('linksGrid');
            const btn = document.getElementById('expandBtn');
            linksExpanded = !linksExpanded;
            grid.style.maxHeight = linksExpanded ? '500px' : '100px';
            btn.innerHTML = linksExpanded ? '<i class="fas fa-chevron-up mr-1"></i>Recolher' : '<i class="fas fa-chevron-down mr-1"></i>Expandir';
        }

        function openAddLinkModal() {
            document.getElementById('linkModal').classList.remove('hidden');
            document.getElementById('linkModal').classList.add('flex');
            updateFolderOptions();
        }

        function closeLinkModal() {
            document.getElementById('linkModal').classList.add('hidden');
            document.getElementById('linkModal').classList.remove('flex');
            document.getElementById('linkName').value = '';
            document.getElementById('linkUrl').value = '';
            document.getElementById('faviconPreview').classList.add('hidden');
        }

        function addLink() {
            const name = document.getElementById('linkName').value.trim();
            const url = document.getElementById('linkUrl').value.trim();
            const folder = document.getElementById('linkFolder').value;
            if (name && url) {
                links.push({ name, url, icon: 'fas fa-link', folder });
                renderLinks();
                closeLinkModal();
                showToast('success', 'Link adicionado', `"${name}" foi salvo nos favoritos`);
            } else {
                showToast('error', 'Erro', 'Nome e URL sÃ£o obrigatÃ³rios');
            }
        }

        function deleteLink(index) {
            const link = links[index];
            showConfirmModal(
                'Excluir Link',
                `Tem certeza que deseja excluir "${link?.name || 'este link'}"?`,
                () => {
                    links.splice(index, 1);
                    renderLinks();
                    showToast('success', 'Link excluÃ­do', 'O link foi removido com sucesso');
                }
            );
        }

        function saveLinks() {
            localStorage.setItem('dashboardLinks', JSON.stringify(links));
        }

        // ===== FOLDERS =====
        function openAddFolderModal() {
            document.getElementById('folderModal').classList.remove('hidden');
            document.getElementById('folderModal').classList.add('flex');
        }

        function closeFolderModal() {
            document.getElementById('folderModal').classList.add('hidden');
            document.getElementById('folderModal').classList.remove('flex');
            document.getElementById('folderName').value = '';
        }

        function addFolder() {
            const name = document.getElementById('folderName').value.trim();
            if (name && !folders.includes(name)) {
                folders.push(name);
                localStorage.setItem('dashboardFolders', JSON.stringify(folders));
                updateFolderOptions();
                closeFolderModal();
            }
        }

        // ===== KANBAN =====
        const categoryEmojis = {
            trabalho: 'ðŸ’¼',
            pessoal: 'ðŸ ',
            estudos: 'ðŸ“š',
            saude: 'â¤ï¸',
            financeiro: 'ðŸ’°',
            outros: 'ðŸ“Œ'
        };

        function generateId() {
            return 'id_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function getDueDateStatus(dueDate) {
            if (!dueDate) return { class: '', text: '' };
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const due = new Date(dueDate + 'T00:00:00');
            const diffDays = Math.ceil((due - today) / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) return { class: 'overdue', text: `âš ï¸ ${Math.abs(diffDays)}d atrasada` };
            if (diffDays === 0) return { class: 'due-soon', text: 'ðŸ”¥ Hoje!' };
            if (diffDays === 1) return { class: 'due-soon', text: 'â° AmanhÃ£' };
            if (diffDays <= 3) return { class: 'due-soon', text: `ðŸ“… ${diffDays}d` };
            return { class: '', text: `ðŸ“… ${due.toLocaleDateString('pt-BR')}` };
        }

        function updateTaskCounter() {
            const todoCount = notes.filter(n => n.columnId === 'todo' || (!n.columnId && columns[0])).length;
            const doingCount = notes.filter(n => n.columnId === 'doing').length;
            const doneCount = notes.filter(n => n.columnId === 'done' || n.completed).length;
            
            document.getElementById('todoCount').textContent = todoCount;
            document.getElementById('doingCount').textContent = doingCount;
            document.getElementById('doneCount').textContent = doneCount;
        }

        function highlightSearchTerm(text) {
            const searchTerm = document.getElementById('taskSearch')?.value?.trim()?.toLowerCase();
            if (!searchTerm || !text) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }

        function getFilteredNotes() {
            const search = document.getElementById('taskSearch')?.value?.toLowerCase() || '';
            const category = document.getElementById('filterCategory')?.value || 'all';
            const priority = document.getElementById('filterPriority')?.value || 'all';
            const color = document.getElementById('filterColor')?.value || 'all';
            
            return notes.filter(note => {
                const matchSearch = !search || 
                    note.title?.toLowerCase().includes(search) || 
                    note.content?.toLowerCase().includes(search);
                const matchCategory = category === 'all' || note.category === category;
                const matchPriority = priority === 'all' || note.priority === priority;
                const matchColor = color === 'all' || note.color === color;
                
                return matchSearch && matchCategory && matchPriority && matchColor;
            });
        }

        function filterTasks() {
            renderKanban();
        }

        function renderKanban() {
            const board = document.getElementById('kanbanBoard');
            const filteredNotes = getFilteredNotes();
            
            board.innerHTML = columns.map((column, colIndex) => {
                const columnNotes = filteredNotes.filter(n => {
                    if (!n.columnId) {
                        // Migrate old notes to first column
                        return colIndex === 0;
                    }
                    return n.columnId === column.id;
                });
                
                return `
                    <div class="kanban-column" 
                        data-column-id="${column.id}"
                        ondragover="columnDragOver(event)"
                        ondragleave="columnDragLeave(event)"
                        ondrop="dropInColumn(event, '${column.id}')">
                        <div class="kanban-column-header col-${column.color}"
                            draggable="true"
                            ondragstart="columnDragStart(event, '${column.id}')"
                            ondragend="columnDragEnd(event)">
                            <div class="flex items-center gap-2">
                                <span class="font-semibold title-font">${column.name}</span>
                                <span class="column-count">${columnNotes.length}</span>
                            </div>
                            <div class="column-actions">
                                <button onclick="editColumn('${column.id}')" class="column-action-btn" title="Editar">
                                    <i class="fas fa-pen"></i>
                                </button>
                                ${columns.length > 1 ? `
                                <button onclick="deleteColumn('${column.id}')" class="column-action-btn hover:!bg-red-500/50" title="Excluir">
                                    <i class="fas fa-trash"></i>
                                </button>
                                ` : ''}
                            </div>
                        </div>
                        <div class="kanban-column-body" data-column-id="${column.id}">
                            ${columnNotes.length === 0 ? `
                                <div class="empty-column-message">
                                    <i class="fas fa-inbox text-2xl mb-2 opacity-30"></i>
                                    <p>Nenhuma tarefa</p>
                                </div>
                            ` : ''}
                            ${columnNotes.map(note => renderKanbanCard(note)).join('')}
                            <div class="kanban-drop-zone" data-column-id="${column.id}"></div>
                        </div>
                    </div>
                `;
            }).join('');
            
            updateTaskCounter();
            saveNotes();
            saveColumns();
        }

        function renderKanbanCard(note) {
            const rotation = (Math.random() * 4 - 2).toFixed(2);
            const dueStatus = getDueDateStatus(note.dueDate);
            const isCompleted = note.columnId === 'done' || note.completed;
            
            return `
                <div class="kanban-card post-it post-it-${note.color} rounded-xl p-3 text-gray-800 relative priority-${note.priority || 'medium'} ${dueStatus.class} ${isCompleted ? 'completed' : ''}"
                    style="--rotation: ${rotation}deg"
                    data-note-id="${note.id}"
                    draggable="true"
                    ondragstart="cardDragStart(event, '${note.id}')"
                    ondragend="cardDragEnd(event)"
                    ondblclick="toggleNoteComplete('${note.id}')">
                    <div class="absolute top-1 right-1 flex gap-1 opacity-0 hover:opacity-100 transition">
                        <button onclick="event.stopPropagation(); openEditNoteModal('${note.id}')" 
                            class="w-5 h-5 bg-blue-500/70 hover:bg-blue-500 rounded-full text-xs transition text-white">
                            <i class="fas fa-pen text-[8px]"></i>
                        </button>
                        <button onclick="event.stopPropagation(); deleteNote('${note.id}')" 
                            class="w-5 h-5 bg-black/20 hover:bg-red-500 rounded-full text-xs transition">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="flex items-center gap-1 mb-1 flex-wrap">
                        <span class="category-tag">${categoryEmojis[note.category] || 'ðŸ“Œ'}</span>
                        ${dueStatus.text ? `<span class="text-[10px] ${dueStatus.class === 'overdue' ? 'text-red-600 font-bold' : 'opacity-70'}">${dueStatus.text}</span>` : ''}
                    </div>
                    
                    <h4 class="card-title font-bold text-sm mb-1 pr-8 cursor-pointer ${isCompleted ? 'line-through opacity-60' : ''}" onclick="event.stopPropagation(); openEditNoteModal('${note.id}')">${highlightSearchTerm(note.title)}</h4>
                    ${note.content ? `<p class="text-xs opacity-70 line-clamp-2 ${isCompleted ? 'line-through opacity-40' : ''}">${highlightSearchTerm(note.content)}</p>` : ''}
                    
                    <div class="flex items-center justify-between mt-2 text-[10px] opacity-50">
                        <span>${note.date}</span>
                        ${isCompleted ? '<i class="fas fa-check-circle text-green-600 text-sm"></i>' : ''}
                    </div>
                </div>
            `;
        }

        // Card Drag & Drop
        function cardDragStart(e, noteId) {
            draggedCardId = noteId;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', noteId);
            
            // Add ghost class after a small delay
            setTimeout(() => {
                e.target.classList.add('drag-ghost');
            }, 0);
        }

        function cardDragEnd(e) {
            e.target.classList.remove('dragging', 'drag-ghost');
            draggedCardId = null;
            
            // Remove all active states
            document.querySelectorAll('.kanban-drop-zone').forEach(zone => {
                zone.classList.remove('active');
            });
            document.querySelectorAll('.kanban-column').forEach(col => {
                col.classList.remove('drag-over');
            });
        }

        function columnDragOver(e) {
            e.preventDefault();
            if (draggedCardId) {
                e.currentTarget.classList.add('drag-over');
                const dropZone = e.currentTarget.querySelector('.kanban-drop-zone');
                if (dropZone) dropZone.classList.add('active');
            }
        }

        function columnDragLeave(e) {
            if (!e.currentTarget.contains(e.relatedTarget)) {
                e.currentTarget.classList.remove('drag-over');
                const dropZone = e.currentTarget.querySelector('.kanban-drop-zone');
                if (dropZone) dropZone.classList.remove('active');
            }
        }

        function dropInColumn(e, columnId) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            const dropZone = e.currentTarget.querySelector('.kanban-drop-zone');
            if (dropZone) dropZone.classList.remove('active');
            
            if (draggedCardId) {
                const noteIndex = notes.findIndex(n => n.id === draggedCardId);
                if (noteIndex !== -1) {
                    notes[noteIndex].columnId = columnId;
                    // Auto-complete if moved to 'done' column
                    if (columnId === 'done') {
                        notes[noteIndex].completed = true;
                    } else {
                        notes[noteIndex].completed = false;
                    }
                    renderKanban();
                }
            }
            
            draggedCardId = null;
        }

        // Column Drag & Drop
        function columnDragStart(e, columnId) {
            if (draggedCardId) {
                e.preventDefault();
                return;
            }
            draggedColumnId = columnId;
            e.dataTransfer.effectAllowed = 'move';
            e.target.closest('.kanban-column').style.opacity = '0.5';
        }

        function columnDragEnd(e) {
            e.target.closest('.kanban-column').style.opacity = '1';
            draggedColumnId = null;
        }

        // Column Management
        function openAddColumnModal() {
            document.getElementById('columnModal').classList.remove('hidden');
            document.getElementById('columnModal').classList.add('flex');
            selectColumnColor('blue');
        }

        function closeColumnModal() {
            document.getElementById('columnModal').classList.add('hidden');
            document.getElementById('columnModal').classList.remove('flex');
            document.getElementById('columnName').value = '';
        }

        function selectColumnColor(color) {
            selectedColumnColor = color;
            document.querySelectorAll('.column-color-btn').forEach(btn => {
                btn.classList.remove('border-white');
                btn.classList.add('border-transparent');
            });
            document.querySelector(`.column-color-btn[data-color="${color}"]`)?.classList.remove('border-transparent');
            document.querySelector(`.column-color-btn[data-color="${color}"]`)?.classList.add('border-white');
        }

        function addColumn() {
            const name = document.getElementById('columnName').value.trim();
            if (name) {
                columns.push({
                    id: generateId(),
                    name: name,
                    color: selectedColumnColor
                });
                renderKanban();
                closeColumnModal();
            }
        }

        function editColumn(columnId) {
            const column = columns.find(c => c.id === columnId);
            if (!column) return;
            
            const newName = prompt('Novo nome da coluna:', column.name);
            if (newName && newName.trim()) {
                column.name = newName.trim();
                renderKanban();
            }
        }

        function deleteColumn(columnId) {
            if (columns.length <= 1) {
                alert('VocÃª precisa ter pelo menos uma coluna!');
                return;
            }
            
            const notesInColumn = notes.filter(n => n.columnId === columnId);
            if (notesInColumn.length > 0) {
                if (!confirm(`Esta coluna tem ${notesInColumn.length} tarefa(s). Mover para a primeira coluna?`)) {
                    return;
                }
                // Move notes to first column
                const firstColumn = columns.find(c => c.id !== columnId);
                notesInColumn.forEach(note => {
                    note.columnId = firstColumn.id;
                });
            }
            
            columns = columns.filter(c => c.id !== columnId);
            renderKanban();
        }

        function saveColumns() {
            localStorage.setItem('kanbanColumns', JSON.stringify(columns));
        }

        // Notes functions
        function selectNoteColor(color) {
            selectedNoteColor = color;
            document.querySelectorAll('.color-btn').forEach(btn => {
                btn.classList.remove('border-white');
                btn.classList.add('border-transparent');
            });
            document.querySelector(`[data-color="${color}"]`)?.classList.remove('border-transparent');
            document.querySelector(`[data-color="${color}"]`)?.classList.add('border-white');
        }

        function selectPriority(priority) {
            selectedPriority = priority;
            document.querySelectorAll('.priority-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-white');
            });
            document.querySelector(`[data-priority="${priority}"]`)?.classList.add('ring-2', 'ring-white');
        }

        function updateColumnOptions() {
            const select = document.getElementById('noteColumn');
            if (select) {
                select.innerHTML = columns.map(col => 
                    `<option value="${col.id}">${col.name}</option>`
                ).join('');
            }
        }

        function openAddNoteModal() {
            document.getElementById('noteModal').classList.remove('hidden');
            document.getElementById('noteModal').classList.add('flex');
            updateColumnOptions();
            selectNoteColor('yellow');
            selectPriority('medium');
        }

        function closeNoteModal() {
            document.getElementById('noteModal').classList.add('hidden');
            document.getElementById('noteModal').classList.remove('flex');
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteContent').value = '';
            document.getElementById('noteDueDate').value = '';
        }

        function addNote() {
            const title = document.getElementById('noteTitle').value.trim();
            const content = document.getElementById('noteContent').value.trim();
            const category = document.getElementById('noteCategory').value;
            const dueDate = document.getElementById('noteDueDate').value;
            const columnId = document.getElementById('noteColumn').value || columns[0].id;
            
            if (title) {
                const now = new Date();
                notes.push({
                    id: generateId(),
                    title,
                    content,
                    color: selectedNoteColor,
                    category,
                    priority: selectedPriority,
                    dueDate,
                    columnId,
                    completed: columnId === 'done',
                    date: now.toLocaleDateString('pt-BR')
                });
                renderKanban();
                closeNoteModal();
                showToast('success', 'Tarefa criada', `"${title}" foi adicionada ao quadro`);
            } else {
                showToast('error', 'Erro', 'O tÃ­tulo Ã© obrigatÃ³rio');
            }
        }

        function deleteNote(noteId) {
            const note = notes.find(n => n.id === noteId);
            showConfirmModal(
                'Excluir Tarefa',
                `Tem certeza que deseja excluir "${note?.title || 'esta tarefa'}"?`,
                () => {
                    notes = notes.filter(n => n.id !== noteId);
                    renderKanban();
                    showToast('success', 'Tarefa excluÃ­da', 'A tarefa foi removida com sucesso');
                }
            );
        }

        function toggleNoteComplete(noteId) {
            const note = notes.find(n => n.id === noteId);
            if (note) {
                note.completed = !note.completed;
                if (note.completed && note.columnId !== 'done') {
                    // Move to done column
                    const doneColumn = columns.find(c => c.id === 'done');
                    if (doneColumn) {
                        note.columnId = 'done';
                    }
                    showToast('success', 'Tarefa concluÃ­da! ðŸŽ‰', `"${note.title}" foi marcada como feita`);
                } else if (!note.completed) {
                    showToast('info', 'Tarefa reaberta', `"${note.title}" foi marcada como pendente`);
                }
                renderKanban();
            }
        }

        function saveNotes() {
            localStorage.setItem('dashboardNotes', JSON.stringify(notes));
        }

        // Migrate old notes to have IDs and columnId
        function migrateNotes() {
            let needsSave = false;
            notes = notes.map(note => {
                if (!note.id) {
                    note.id = generateId();
                    needsSave = true;
                }
                if (!note.columnId) {
                    note.columnId = note.completed ? 'done' : 'todo';
                    needsSave = true;
                }
                return note;
            });
            if (needsSave) saveNotes();
        }

        // ===== POMODORO =====
        function updatePomodoroDisplay() {
            const minutes = Math.floor(pomodoroTime / 60);
            const seconds = pomodoroTime % 60;
            document.getElementById('pomodoroTime').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            const progress = document.getElementById('pomodoroProgress');
            const circumference = 364.42;
            const offset = circumference - (pomodoroTime / pomodoroInitialTime) * circumference;
            progress.style.strokeDashoffset = offset;
            progress.style.stroke = isBreak ? '#22c55e' : '#ef4444';
        }

        function startPomodoro() {
            if (!pomodoroRunning) {
                pomodoroRunning = true;
                
                // Ask to enter focus mode if not in break and not already in focus mode
                if (!isBreak && !focusModeActive) {
                    const enterFocus = localStorage.getItem('autoFocusMode') !== 'false';
                    if (enterFocus) {
                        setTimeout(() => enterFocusMode(), 500);
                    }
                }
                
                pomodoroInterval = setInterval(() => {
                    if (pomodoroTime > 0) {
                        pomodoroTime--;
                        updatePomodoroDisplay();
                        
                        // Update focus mode timer if active
                        if (focusModeActive) {
                            const minutes = Math.floor(pomodoroTime / 60);
                            const seconds = pomodoroTime % 60;
                            document.getElementById('focusTimer').textContent = 
                                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                            
                            // Update progress circle
                            const circle = document.getElementById('focusProgressCircle');
                            const circumference = 1131;
                            const progress = pomodoroTime / pomodoroInitialTime;
                            circle.style.strokeDashoffset = circumference * (1 - progress);
                        }
                    } else {
                        clearInterval(pomodoroInterval);
                        pomodoroRunning = false;
                        playNotification();
                        if (!isBreak) {
                            pomodoroSessions++;
                            localStorage.setItem('pomodoroSessions', pomodoroSessions);
                            document.getElementById('pomodoroCount').textContent = `SessÃµes: ${pomodoroSessions}`;
                            isBreak = true;
                            document.getElementById('pomodoroMode').textContent = 'Modo: Descanso';
                            setPomodoro(5);
                        } else {
                            isBreak = false;
                            document.getElementById('pomodoroMode').textContent = 'Modo: Foco';
                            setPomodoro(25);
                        }
                    }
                }, 1000);
            }
        }

        function pausePomodoro() {
            pomodoroRunning = false;
            clearInterval(pomodoroInterval);
        }

        function resetPomodoro() {
            pausePomodoro();
            pomodoroTime = pomodoroInitialTime;
            updatePomodoroDisplay();
        }

        function setPomodoro(minutes) {
            pausePomodoro();
            pomodoroTime = minutes * 60;
            pomodoroInitialTime = minutes * 60;
            updatePomodoroDisplay();
        }

        function playNotification() {
            // Use improved sound
            playPomodoroEndSound();
            
            // Exit focus mode when timer ends
            if (focusModeActive) {
                exitFocusMode();
            }
            
            // Show toast
            if (isBreak) {
                showToast('success', 'ðŸŽ‰ Tempo de Foco ConcluÃ­do!', 'Hora de um descanso merecido.');
            } else {
                showToast('info', 'â˜• Descanso Terminado!', 'Pronto para mais uma sessÃ£o?');
            }
            
            // Browser notification
            if (Notification.permission === 'granted') {
                new Notification(isBreak ? 'ðŸŽ‰ Pomodoro ConcluÃ­do!' : 'â˜• Descanso Terminado!', { 
                    body: isBreak ? 'Hora de um descanso merecido.' : 'Pronto para focar novamente?',
                    icon: 'ðŸ…',
                    tag: 'pomodoro'
                });
            }
        }

        // ===== WATER TRACKER =====
        function checkWaterDate() {
            const today = new Date().toDateString();
            if (waterDate !== today) {
                waterCount = 0;
                waterDate = today;
                localStorage.setItem('waterCount', waterCount);
                localStorage.setItem('waterDate', waterDate);
            }
        }

        function updateWaterDisplay() {
            const fill = document.getElementById('waterFill');
            const count = document.getElementById('waterCount');
            const goal = document.getElementById('waterGoal');
            const progress = document.getElementById('waterProgress');
            const message = document.getElementById('waterMessage');
            
            const percentage = Math.min((waterCount / waterGoal) * 100, 100);
            
            fill.style.height = percentage + '%';
            count.textContent = waterCount;
            goal.textContent = waterGoal + ' copos';
            progress.style.width = percentage + '%';
            
            // Update message based on progress
            if (waterCount === 0) {
                message.innerHTML = 'ðŸ’§ Hora de beber Ã¡gua!';
            } else if (waterCount < waterGoal / 2) {
                message.innerHTML = 'ðŸ’ª Continue assim!';
            } else if (waterCount < waterGoal) {
                message.innerHTML = 'ðŸŒŠ Quase lÃ¡!';
            } else if (waterCount === waterGoal) {
                message.innerHTML = 'ðŸŽ‰ Meta atingida! ParabÃ©ns!';
            } else {
                message.innerHTML = 'â­ VocÃª estÃ¡ super hidratado!';
            }
        }

        function addWater(amount) {
            waterCount += amount;
            localStorage.setItem('waterCount', waterCount);
            
            // Animation
            const fill = document.getElementById('waterFill');
            fill.classList.add('water-splash');
            setTimeout(() => fill.classList.remove('water-splash'), 500);
            
            updateWaterDisplay();
            
            // Celebration at goal
            if (waterCount === waterGoal) {
                confettiCelebration();
            }
        }

        function removeWater(amount) {
            waterCount = Math.max(0, waterCount - amount);
            localStorage.setItem('waterCount', waterCount);
            updateWaterDisplay();
        }

        function resetWater() {
            if (confirm('Resetar contador de Ã¡gua?')) {
                waterCount = 0;
                localStorage.setItem('waterCount', waterCount);
                updateWaterDisplay();
            }
        }

        function setWaterGoal() {
            const newGoal = prompt('Defina sua meta diÃ¡ria de copos:', waterGoal);
            if (newGoal && !isNaN(newGoal) && parseInt(newGoal) > 0) {
                waterGoal = parseInt(newGoal);
                localStorage.setItem('waterGoal', waterGoal);
                updateWaterDisplay();
            }
        }

        function confettiCelebration() {
            // Simple celebration effect
            const message = document.getElementById('waterMessage');
            message.innerHTML = 'ðŸŽ‰âœ¨ðŸŽŠ META ATINGIDA! ðŸŽŠâœ¨ðŸŽ‰';
            message.style.transform = 'scale(1.1)';
            setTimeout(() => {
                message.style.transform = 'scale(1)';
            }, 1000);
        }

        // ===== MOOD TRACKER =====
        function getTodayString() {
            return new Date().toISOString().split('T')[0];
        }

        function initMoodTracker() {
            const today = getTodayString();
            document.getElementById('moodDate').textContent = new Date().toLocaleDateString('pt-BR', { weekday: 'short', day: 'numeric', month: 'short' });
            
            // Check if mood was set today
            const todayMood = moodHistory.find(m => m.date === today);
            if (todayMood) {
                updateMoodDisplay(todayMood.mood);
                document.getElementById('moodNote').value = todayMood.note || '';
                highlightMoodButton(todayMood.mood);
            }
            
            renderMoodHistory();
        }

        function setMood(mood) {
            const today = getTodayString();
            const note = document.getElementById('moodNote').value;
            
            // Remove today's entry if exists
            moodHistory = moodHistory.filter(m => m.date !== today);
            
            // Add new entry
            moodHistory.push({
                date: today,
                mood: mood,
                note: note,
                timestamp: Date.now()
            });
            
            // Keep only last 30 days
            moodHistory = moodHistory.slice(-30);
            
            localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
            
            updateMoodDisplay(mood);
            highlightMoodButton(mood);
            renderMoodHistory();
        }

        function updateMoodDisplay(mood) {
            const emojiEl = document.getElementById('currentMoodEmoji');
            const textEl = document.getElementById('currentMoodText');
            
            emojiEl.textContent = moodEmojis[mood];
            textEl.textContent = moodTexts[mood];
            
            // Bounce animation
            emojiEl.classList.remove('bounce');
            void emojiEl.offsetWidth;
            emojiEl.classList.add('bounce');
        }

        function highlightMoodButton(mood) {
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.mood-btn[data-mood="${mood}"]`)?.classList.add('selected');
        }

        function saveMoodNote() {
            const today = getTodayString();
            const note = document.getElementById('moodNote').value;
            
            const todayMood = moodHistory.find(m => m.date === today);
            if (todayMood) {
                todayMood.note = note;
                localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
            }
        }

        function renderMoodHistory() {
            const container = document.getElementById('moodHistory');
            const days = ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'];
            const today = new Date();
            
            let html = '';
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                const dayOfWeek = days[date.getDay()];
                
                const moodEntry = moodHistory.find(m => m.date === dateStr);
                const emoji = moodEntry ? moodEmojis[moodEntry.mood] : 'Â·';
                const isToday = i === 0;
                const tooltip = moodEntry ? moodEntry.note || moodTexts[moodEntry.mood] : 'Sem registro';
                
                html += `
                    <div class="flex flex-col items-center" title="${tooltip}">
                        <span class="text-[10px] text-white/40 mb-1">${dayOfWeek}</span>
                        <div class="mood-history-dot ${isToday ? 'today' : ''}">${emoji}</div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
            
            // Update trend and weekly average
            updateMoodTrendAndAverage();
        }

        function updateMoodTrendAndAverage() {
            const today = new Date();
            const last7Days = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                const moodEntry = moodHistory.find(m => m.date === dateStr);
                if (moodEntry) {
                    last7Days.push(moodEntry);
                }
            }
            
            // Calculate average
            const moodValues = { terrible: 1, bad: 2, okay: 3, good: 4, great: 5 };
            const moodFromValue = { 1: 'terrible', 2: 'bad', 3: 'okay', 4: 'good', 5: 'great' };
            
            if (last7Days.length > 0) {
                const sum = last7Days.reduce((acc, m) => acc + moodValues[m.mood], 0);
                const avg = sum / last7Days.length;
                const avgMood = moodFromValue[Math.round(avg)];
                
                document.getElementById('moodAvgEmoji').textContent = moodEmojis[avgMood];
                document.getElementById('moodAvgScore').textContent = `${avg.toFixed(1)}/5`;
                
                // Calculate trend (comparing first half vs second half of week)
                if (last7Days.length >= 4) {
                    const firstHalf = last7Days.slice(0, Math.floor(last7Days.length / 2));
                    const secondHalf = last7Days.slice(Math.floor(last7Days.length / 2));
                    
                    const firstAvg = firstHalf.reduce((acc, m) => acc + moodValues[m.mood], 0) / firstHalf.length;
                    const secondAvg = secondHalf.reduce((acc, m) => acc + moodValues[m.mood], 0) / secondHalf.length;
                    
                    const trendEl = document.getElementById('moodTrend');
                    if (secondAvg > firstAvg + 0.3) {
                        trendEl.innerHTML = '<i class="fas fa-arrow-up mood-trend-up"></i> <span class="mood-trend-up">Melhorando</span>';
                    } else if (secondAvg < firstAvg - 0.3) {
                        trendEl.innerHTML = '<i class="fas fa-arrow-down mood-trend-down"></i> <span class="mood-trend-down">Piorando</span>';
                    } else {
                        trendEl.innerHTML = '<i class="fas fa-minus mood-trend-stable"></i> <span class="mood-trend-stable">EstÃ¡vel</span>';
                    }
                }
            } else {
                document.getElementById('moodAvgEmoji').textContent = 'â“';
                document.getElementById('moodAvgScore').textContent = '--';
                document.getElementById('moodTrend').textContent = '';
            }
        }

        // ===== MOOD REPORT =====
        let reportPeriod = 7;

        function openMoodReportModal() {
            document.getElementById('moodReportModal').classList.remove('hidden');
            document.getElementById('moodReportModal').classList.add('flex');
            setReportPeriod(7);
        }

        function closeMoodReportModal() {
            document.getElementById('moodReportModal').classList.add('hidden');
            document.getElementById('moodReportModal').classList.remove('flex');
        }

        function setReportPeriod(days) {
            reportPeriod = days;
            
            // Update button states
            document.querySelectorAll('.report-period-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-pink-500/30');
                btn.classList.add('bg-white/10');
            });
            document.querySelector(`.report-period-btn[data-period="${days}"]`)?.classList.add('active', 'bg-pink-500/30');
            document.querySelector(`.report-period-btn[data-period="${days}"]`)?.classList.remove('bg-white/10');
            
            generateMoodReport();
        }

        function generateMoodReport() {
            const today = new Date();
            const moodValues = { terrible: 1, bad: 2, okay: 3, good: 4, great: 5 };
            const moodFromValue = { 1: 'terrible', 2: 'bad', 3: 'okay', 4: 'good', 5: 'great' };
            const moodLabels = { terrible: 'PÃ©ssimo', bad: 'Mal', okay: 'Ok', good: 'Bom', great: 'Ã“timo' };
            const moodColors = { terrible: '#ef4444', bad: '#f97316', okay: '#eab308', good: '#22c55e', great: '#10b981' };
            
            // Get data for the period
            const periodData = [];
            for (let i = reportPeriod - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                const moodEntry = moodHistory.find(m => m.date === dateStr);
                periodData.push({
                    date: dateStr,
                    dayOfWeek: date.toLocaleDateString('pt-BR', { weekday: 'short' }),
                    dayNum: date.getDate(),
                    mood: moodEntry?.mood || null,
                    note: moodEntry?.note || null
                });
            }
            
            const loggedDays = periodData.filter(d => d.mood !== null);
            
            // Calculate statistics
            if (loggedDays.length > 0) {
                // Average
                const sum = loggedDays.reduce((acc, d) => acc + moodValues[d.mood], 0);
                const avg = sum / loggedDays.length;
                const avgMood = moodFromValue[Math.round(avg)];
                
                document.getElementById('reportAvgEmoji').textContent = moodEmojis[avgMood];
                document.getElementById('reportAvgText').textContent = moodLabels[avgMood];
                
                // Best and worst days
                const sortedByMood = [...loggedDays].sort((a, b) => moodValues[b.mood] - moodValues[a.mood]);
                const bestDay = sortedByMood[0];
                const worstDay = sortedByMood[sortedByMood.length - 1];
                
                document.getElementById('reportBestEmoji').textContent = moodEmojis[bestDay.mood];
                document.getElementById('reportBestDay').textContent = `${bestDay.dayNum}/${new Date(bestDay.date).getMonth() + 1}`;
                
                document.getElementById('reportWorstEmoji').textContent = moodEmojis[worstDay.mood];
                document.getElementById('reportWorstDay').textContent = `${worstDay.dayNum}/${new Date(worstDay.date).getMonth() + 1}`;
            } else {
                document.getElementById('reportAvgEmoji').textContent = 'â“';
                document.getElementById('reportAvgText').textContent = 'Sem dados';
                document.getElementById('reportBestEmoji').textContent = 'â“';
                document.getElementById('reportBestDay').textContent = '--';
                document.getElementById('reportWorstEmoji').textContent = 'â“';
                document.getElementById('reportWorstDay').textContent = '--';
            }
            
            // Days logged
            document.getElementById('reportDaysLogged').textContent = `${loggedDays.length}/${reportPeriod}`;
            
            // Calculate streak
            let streak = 0;
            for (let i = 0; i < periodData.length; i++) {
                const d = periodData[periodData.length - 1 - i];
                if (d.mood !== null) {
                    streak++;
                } else if (i > 0) {
                    break;
                }
            }
            document.getElementById('reportStreak').textContent = `${streak} dias`;
            
            // Generate chart
            const chartContainer = document.getElementById('moodChart');
            const labelsContainer = document.getElementById('moodChartLabels');
            
            const maxBars = reportPeriod <= 7 ? reportPeriod : (reportPeriod <= 14 ? 14 : 15);
            const step = reportPeriod <= 14 ? 1 : 2;
            
            let chartHtml = '';
            let labelsHtml = '';
            
            for (let i = 0; i < periodData.length; i += step) {
                const d = periodData[i];
                const height = d.mood ? (moodValues[d.mood] / 5) * 100 : 10;
                const moodClass = d.mood || 'empty';
                const emoji = d.mood ? moodEmojis[d.mood] : '';
                
                chartHtml += `<div class="mood-chart-bar ${moodClass} flex-1" style="height: ${height}%;" data-emoji="${emoji}" title="${d.dayOfWeek} ${d.dayNum}: ${d.mood ? moodLabels[d.mood] : 'Sem registro'}"></div>`;
                
                if (i % (reportPeriod <= 7 ? 1 : (reportPeriod <= 14 ? 2 : 4)) === 0) {
                    labelsHtml += `<span>${d.dayNum}</span>`;
                }
            }
            
            chartContainer.innerHTML = chartHtml;
            labelsContainer.innerHTML = labelsHtml;
            
            // Generate distribution
            const distribution = { terrible: 0, bad: 0, okay: 0, good: 0, great: 0 };
            loggedDays.forEach(d => distribution[d.mood]++);
            
            const distContainer = document.getElementById('moodDistribution');
            const total = loggedDays.length || 1;
            
            let distHtml = '';
            Object.entries(distribution).reverse().forEach(([mood, count]) => {
                const percentage = (count / total) * 100;
                distHtml += `
                    <div class="flex items-center gap-2">
                        <span class="w-6 text-center">${moodEmojis[mood]}</span>
                        <span class="text-xs w-14 text-white/60">${moodLabels[mood]}</span>
                        <div class="flex-1 bg-white/10 rounded-full h-2 overflow-hidden">
                            <div class="mood-dist-bar h-full" style="width: ${percentage}%; background: ${moodColors[mood]};"></div>
                        </div>
                        <span class="text-xs w-8 text-right text-white/60">${count}</span>
                    </div>
                `;
            });
            distContainer.innerHTML = distHtml;
            
            // Generate insights
            const insightsContainer = document.getElementById('moodInsights');
            let insights = [];
            
            if (loggedDays.length === 0) {
                insights.push({ icon: 'ðŸ“', color: 'bg-blue-500/30', text: 'Comece a registrar seu humor para ver insights personalizados!' });
            } else {
                // Consistency insight
                const consistency = (loggedDays.length / reportPeriod) * 100;
                if (consistency >= 80) {
                    insights.push({ icon: 'ðŸ†', color: 'bg-yellow-500/30', text: `Excelente! VocÃª registrou ${consistency.toFixed(0)}% dos dias.` });
                } else if (consistency >= 50) {
                    insights.push({ icon: 'ðŸ‘', color: 'bg-green-500/30', text: `Bom progresso! ${consistency.toFixed(0)}% dos dias registrados.` });
                } else {
                    insights.push({ icon: 'ðŸ’ª', color: 'bg-orange-500/30', text: `Tente registrar mais! Apenas ${consistency.toFixed(0)}% dos dias registrados.` });
                }
                
                // Mood trend insight
                if (loggedDays.length >= 3) {
                    const firstHalf = loggedDays.slice(0, Math.floor(loggedDays.length / 2));
                    const secondHalf = loggedDays.slice(Math.floor(loggedDays.length / 2));
                    const firstAvg = firstHalf.reduce((acc, d) => acc + moodValues[d.mood], 0) / firstHalf.length;
                    const secondAvg = secondHalf.reduce((acc, d) => acc + moodValues[d.mood], 0) / secondHalf.length;
                    
                    if (secondAvg > firstAvg + 0.5) {
                        insights.push({ icon: 'ðŸ“ˆ', color: 'bg-green-500/30', text: 'Seu humor estÃ¡ melhorando! Continue assim!' });
                    } else if (secondAvg < firstAvg - 0.5) {
                        insights.push({ icon: 'ðŸ’™', color: 'bg-blue-500/30', text: 'Seu humor caiu um pouco. Cuide-se e faÃ§a algo relaxante.' });
                    }
                }
                
                // Most common mood
                const mostCommon = Object.entries(distribution).sort((a, b) => b[1] - a[1])[0];
                if (mostCommon[1] > 1) {
                    insights.push({ icon: moodEmojis[mostCommon[0]], color: 'bg-pink-500/30', text: `Seu humor mais frequente: ${moodLabels[mostCommon[0]]} (${mostCommon[1]}x)` });
                }
                
                // Weekend vs weekday
                const weekendDays = loggedDays.filter(d => {
                    const day = new Date(d.date).getDay();
                    return day === 0 || day === 6;
                });
                const weekdayDays = loggedDays.filter(d => {
                    const day = new Date(d.date).getDay();
                    return day !== 0 && day !== 6;
                });
                
                if (weekendDays.length >= 2 && weekdayDays.length >= 2) {
                    const weekendAvg = weekendDays.reduce((acc, d) => acc + moodValues[d.mood], 0) / weekendDays.length;
                    const weekdayAvg = weekdayDays.reduce((acc, d) => acc + moodValues[d.mood], 0) / weekdayDays.length;
                    
                    if (weekendAvg > weekdayAvg + 0.5) {
                        insights.push({ icon: 'ðŸŽ‰', color: 'bg-purple-500/30', text: 'VocÃª Ã© mais feliz nos finais de semana!' });
                    } else if (weekdayAvg > weekendAvg + 0.5) {
                        insights.push({ icon: 'ðŸ’¼', color: 'bg-cyan-500/30', text: 'VocÃª Ã© mais feliz durante a semana!' });
                    }
                }
                
                // Streak insight
                if (streak >= 7) {
                    insights.push({ icon: 'ðŸ”¥', color: 'bg-orange-500/30', text: `IncrÃ­vel! ${streak} dias seguidos registrando humor!` });
                }
            }
            
            insightsContainer.innerHTML = insights.map(i => `
                <div class="insight-item">
                    <div class="insight-icon ${i.color}">${i.icon}</div>
                    <span class="text-white/80">${i.text}</span>
                </div>
            `).join('');
            
            // Generate notes
            const notesContainer = document.getElementById('moodNotes');
            const notesWithContent = loggedDays.filter(d => d.note).slice(-5).reverse();
            
            if (notesWithContent.length > 0) {
                notesContainer.innerHTML = notesWithContent.map(d => `
                    <div class="flex items-start gap-2 p-2 bg-white/5 rounded-lg">
                        <span>${moodEmojis[d.mood]}</span>
                        <div class="flex-1">
                            <div class="text-white/80">${d.note}</div>
                            <div class="text-[10px] text-white/40 mt-1">${new Date(d.date).toLocaleDateString('pt-BR', { weekday: 'short', day: 'numeric', month: 'short' })}</div>
                        </div>
                    </div>
                `).join('');
            } else {
                notesContainer.innerHTML = '<p class="text-white/40 text-center py-2">Nenhuma nota registrada neste perÃ­odo.</p>';
            }
        }

        // ===== TOAST NOTIFICATIONS =====
        function showToast(type, title, message, duration = 4000) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icons = {
                success: 'fa-check',
                error: 'fa-times',
                warning: 'fa-exclamation',
                info: 'fa-info'
            };
            
            toast.innerHTML = `
                <div class="toast-icon"><i class="fas ${icons[type]}"></i></div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    ${message ? `<div class="toast-message">${message}</div>` : ''}
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="toast-progress"></div>
            `;
            
            container.appendChild(toast);
            
            // Auto remove
            setTimeout(() => {
                toast.classList.add('hiding');
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // ===== CONFIRM MODAL =====
        let confirmCallback = null;

        function showConfirmModal(title, message, callback) {
            const modal = document.getElementById('confirmModal');
            document.querySelector('.confirm-title').textContent = title;
            document.getElementById('confirmMessage').textContent = message;
            confirmCallback = callback;
            modal.classList.add('active');
        }

        function closeConfirmModal() {
            const modal = document.getElementById('confirmModal');
            modal.classList.remove('active');
            confirmCallback = null;
        }

        function executeConfirmAction() {
            if (confirmCallback) {
                confirmCallback();
            }
            closeConfirmModal();
        }

        // ===== EDIT NOTE =====
        let editNoteColor = 'yellow';
        let editNotePriority = 'medium';

        function openEditNoteModal(noteId) {
            const note = notes.find(n => n.id === noteId);
            if (!note) return;
            
            document.getElementById('editNoteId').value = noteId;
            document.getElementById('editNoteTitle').value = note.title || '';
            document.getElementById('editNoteContent').value = note.content || '';
            document.getElementById('editNoteDueDate').value = note.dueDate || '';
            document.getElementById('editNoteCategory').value = note.category || 'outros';
            
            // Update column options
            const columnSelect = document.getElementById('editNoteColumn');
            columnSelect.innerHTML = columns.map(col => 
                `<option value="${col.id}" ${col.id === note.columnId ? 'selected' : ''}>${col.name}</option>`
            ).join('');
            
            // Select color
            editNoteColor = note.color || 'yellow';
            selectEditNoteColor(editNoteColor);
            
            // Select priority
            editNotePriority = note.priority || 'medium';
            selectEditPriority(editNotePriority);
            
            document.getElementById('editNoteModal').classList.remove('hidden');
            document.getElementById('editNoteModal').classList.add('flex');
        }

        function closeEditNoteModal() {
            document.getElementById('editNoteModal').classList.add('hidden');
            document.getElementById('editNoteModal').classList.remove('flex');
        }

        function selectEditNoteColor(color) {
            editNoteColor = color;
            document.querySelectorAll('.edit-color-btn').forEach(btn => {
                btn.classList.remove('border-white');
                btn.classList.add('border-transparent');
            });
            document.querySelector(`.edit-color-btn[data-color="${color}"]`)?.classList.remove('border-transparent');
            document.querySelector(`.edit-color-btn[data-color="${color}"]`)?.classList.add('border-white');
        }

        function selectEditPriority(priority) {
            editNotePriority = priority;
            document.querySelectorAll('.edit-priority-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-white');
            });
            document.querySelector(`.edit-priority-btn[data-priority="${priority}"]`)?.classList.add('ring-2', 'ring-white');
        }

        function saveEditedNote() {
            const noteId = document.getElementById('editNoteId').value;
            const note = notes.find(n => n.id === noteId);
            if (!note) return;
            
            const title = document.getElementById('editNoteTitle').value.trim();
            if (!title) {
                showToast('error', 'Erro', 'O tÃ­tulo Ã© obrigatÃ³rio');
                return;
            }
            
            note.title = title;
            note.content = document.getElementById('editNoteContent').value.trim();
            note.category = document.getElementById('editNoteCategory').value;
            note.dueDate = document.getElementById('editNoteDueDate').value;
            note.columnId = document.getElementById('editNoteColumn').value;
            note.color = editNoteColor;
            note.priority = editNotePriority;
            note.completed = note.columnId === 'done';
            
            renderKanban();
            closeEditNoteModal();
            showToast('success', 'Tarefa atualizada', 'As alteraÃ§Ãµes foram salvas');
        }

        // ===== EXPORT / IMPORT DATA =====
        function exportData() {
            const data = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                notes: notes,
                columns: columns,
                links: links,
                folders: folders,
                waterCount: waterCount,
                waterGoal: waterGoal,
                moodHistory: moodHistory,
                pomodoroSessions: pomodoroSessions
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `dashboard-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('success', 'Backup criado', 'Seus dados foram exportados com sucesso');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    showConfirmModal(
                        'Importar Dados',
                        'Isso substituirÃ¡ todos os dados atuais. Deseja continuar?',
                        () => {
                            if (data.notes) {
                                notes = data.notes;
                                localStorage.setItem('dashboardNotes', JSON.stringify(notes));
                            }
                            if (data.columns) {
                                columns = data.columns;
                                localStorage.setItem('kanbanColumns', JSON.stringify(columns));
                            }
                            if (data.links) {
                                links = data.links;
                                localStorage.setItem('dashboardLinks', JSON.stringify(links));
                            }
                            if (data.folders) {
                                folders = data.folders;
                                localStorage.setItem('dashboardFolders', JSON.stringify(folders));
                            }
                            if (data.waterCount !== undefined) {
                                waterCount = data.waterCount;
                                localStorage.setItem('waterCount', waterCount);
                            }
                            if (data.waterGoal !== undefined) {
                                waterGoal = data.waterGoal;
                                localStorage.setItem('waterGoal', waterGoal);
                            }
                            if (data.moodHistory) {
                                moodHistory = data.moodHistory;
                                localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
                            }
                            if (data.pomodoroSessions !== undefined) {
                                pomodoroSessions = data.pomodoroSessions;
                                localStorage.setItem('pomodoroSessions', pomodoroSessions);
                            }
                            
                            // Refresh UI
                            renderLinks();
                            renderKanban();
                            updateWaterDisplay();
                            initMoodTracker();
                            document.getElementById('pomodoroCount').textContent = `SessÃµes: ${pomodoroSessions}`;
                            
                            showToast('success', 'Dados importados', 'Seus dados foram restaurados com sucesso');
                        }
                    );
                } catch (error) {
                    showToast('error', 'Erro na importaÃ§Ã£o', 'O arquivo nÃ£o Ã© vÃ¡lido');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ===== SETTINGS & CUSTOMIZATION =====
        let userSettings = JSON.parse(localStorage.getItem('userSettings')) || {
            userName: 'Filipe',
            theme: 'dark',
            accentColor: 'cyan',
            autoFocusMode: true,
            waterReminders: true
        };

        function openSettingsModal() {
            document.getElementById('settingsModal').classList.remove('hidden');
            document.getElementById('settingsModal').classList.add('flex');
            
            // Load current settings
            document.getElementById('settingsUserName').value = userSettings.userName;
            document.getElementById('autoFocusModeToggle').checked = userSettings.autoFocusMode;
            document.getElementById('waterReminderToggle').checked = userSettings.waterReminders;
            
            // Highlight current theme
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('border-white'));
            document.getElementById(userSettings.theme === 'dark' ? 'themeDarkBtn' : 'themeLightBtn').classList.add('border-white');
            
            // Highlight current accent color
            document.querySelectorAll('.accent-btn').forEach(btn => btn.classList.remove('border-white', 'scale-110'));
            document.querySelector(`.accent-btn[data-color="${userSettings.accentColor}"]`)?.classList.add('border-white', 'scale-110');
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.add('hidden');
            document.getElementById('settingsModal').classList.remove('flex');
        }

        function setTheme(theme) {
            userSettings.theme = theme;
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('border-white'));
            document.getElementById(theme === 'dark' ? 'themeDarkBtn' : 'themeLightBtn').classList.add('border-white');
            applyTheme(theme);
        }

        function applyTheme(theme) {
            const root = document.documentElement;
            if (theme === 'light') {
                root.classList.add('light-theme');
            } else {
                root.classList.remove('light-theme');
            }
        }

        function setAccentColor(color) {
            userSettings.accentColor = color;
            document.querySelectorAll('.accent-btn').forEach(btn => btn.classList.remove('border-white', 'scale-110'));
            document.querySelector(`.accent-btn[data-color="${color}"]`)?.classList.add('border-white', 'scale-110');
            applyAccentColor(color);
        }

        function applyAccentColor(color) {
            const colors = {
                cyan: { primary: '#22d3ee', secondary: '#06b6d4' },
                blue: { primary: '#3b82f6', secondary: '#2563eb' },
                purple: { primary: '#a855f7', secondary: '#9333ea' },
                pink: { primary: '#ec4899', secondary: '#db2777' },
                green: { primary: '#22c55e', secondary: '#16a34a' },
                orange: { primary: '#f97316', secondary: '#ea580c' },
                red: { primary: '#ef4444', secondary: '#dc2626' }
            };
            
            const root = document.documentElement;
            root.style.setProperty('--accent-primary', colors[color].primary);
            root.style.setProperty('--accent-secondary', colors[color].secondary);
        }

        function toggleAutoFocusMode() {
            userSettings.autoFocusMode = document.getElementById('autoFocusModeToggle').checked;
            localStorage.setItem('autoFocusMode', userSettings.autoFocusMode);
        }

        function toggleWaterReminders() {
            userSettings.waterReminders = document.getElementById('waterReminderToggle').checked;
            localStorage.setItem('waterRemindersEnabled', userSettings.waterReminders);
            if (userSettings.waterReminders) {
                startWaterReminder();
            } else if (waterReminderInterval) {
                clearInterval(waterReminderInterval);
            }
        }

        function saveSettings() {
            userSettings.userName = document.getElementById('settingsUserName').value || 'Filipe';
            localStorage.setItem('userSettings', JSON.stringify(userSettings));
            
            // Update splash screen name
            document.querySelector('.splash-name').textContent = userSettings.userName.toUpperCase();
            
            showToast('success', 'ConfiguraÃ§Ãµes Salvas', 'Suas preferÃªncias foram atualizadas!');
            closeSettingsModal();
        }

        function loadSettings() {
            applyTheme(userSettings.theme);
            applyAccentColor(userSettings.accentColor);
            
            // Update name in splash screen
            const splashName = document.querySelector('.splash-name');
            if (splashName) {
                splashName.textContent = userSettings.userName.toUpperCase();
            }
            
            // Set localStorage values
            localStorage.setItem('autoFocusMode', userSettings.autoFocusMode);
            localStorage.setItem('waterRemindersEnabled', userSettings.waterReminders);
        }

        // ===== FOCUS MODE =====
        let focusModeActive = false;
        let focusModeTask = null;

        function enterFocusMode(taskTitle = null) {
            focusModeActive = true;
            focusModeTask = taskTitle;
            
            const overlay = document.getElementById('focusModeOverlay');
            const taskDisplay = document.getElementById('focusTask');
            
            if (taskTitle) {
                taskDisplay.innerHTML = `<i class="fas fa-bullseye mr-2"></i><span>${taskTitle}</span>`;
            } else {
                taskDisplay.innerHTML = `<i class="fas fa-bullseye mr-2"></i><span>Foco total!</span>`;
            }
            
            overlay.classList.add('active');
            updateFocusTimer();
            
            // Start pomodoro if not running
            if (!pomodoroRunning) {
                startPomodoro();
            }
            
            showToast('info', 'Modo Foco Ativado', 'Concentre-se na tarefa. VocÃª consegue! ðŸ’ª');
        }

        function exitFocusMode() {
            focusModeActive = false;
            focusModeTask = null;
            document.getElementById('focusModeOverlay').classList.remove('active');
        }

        function updateFocusTimer() {
            if (!focusModeActive) return;
            
            const minutes = Math.floor(pomodoroTime / 60);
            const seconds = pomodoroTime % 60;
            document.getElementById('focusTimer').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            // Update progress circle
            const circle = document.getElementById('focusProgressCircle');
            const circumference = 1131;
            const progress = pomodoroTime / pomodoroInitialTime;
            circle.style.strokeDashoffset = circumference * (1 - progress);
            
            requestAnimationFrame(() => {
                if (focusModeActive) {
                    setTimeout(updateFocusTimer, 100);
                }
            });
        }

        // ===== KEYBOARD SHORTCUTS =====
        function initKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Don't trigger shortcuts when typing in input/textarea
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    if (e.key === 'Escape') {
                        e.target.blur();
                    }
                    return;
                }
                
                // ? - Show shortcuts help
                if (e.key === '?' || (e.shiftKey && e.key === '/')) {
                    e.preventDefault();
                    openShortcutsModal();
                }
                
                // N - New task
                if (e.key === 'n' || e.key === 'N') {
                    e.preventDefault();
                    openAddNoteModal();
                }
                
                // Space - Toggle Pomodoro
                if (e.key === ' ' && !e.ctrlKey && !e.metaKey) {
                    e.preventDefault();
                    if (pomodoroRunning) {
                        pausePomodoro();
                        showToast('info', 'Pomodoro Pausado', 'Pressione EspaÃ§o para continuar');
                    } else {
                        startPomodoro();
                        showToast('success', 'Pomodoro Iniciado', 'Foco! ðŸ…');
                    }
                }
                
                // F - Focus Mode
                if (e.key === 'f' || e.key === 'F') {
                    e.preventDefault();
                    if (focusModeActive) {
                        exitFocusMode();
                    } else {
                        enterFocusMode();
                    }
                }
                
                // W - Add Water
                if (e.key === 'w' || e.key === 'W') {
                    e.preventDefault();
                    addWater(1);
                    showToast('success', 'Ãgua Adicionada', `${waterCount}/${waterGoal} copos ðŸ’§`);
                }
                
                // Ctrl+K - Search
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
                
                // Ctrl+S - Export
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    exportData();
                }
                
                // Escape - Close modals
                if (e.key === 'Escape') {
                    closeAllModals();
                }
            });
        }

        function openShortcutsModal() {
            document.getElementById('shortcutsModal').classList.add('active');
        }

        function closeShortcutsModal() {
            document.getElementById('shortcutsModal').classList.remove('active');
        }

        function closeAllModals() {
            // Close all modals
            document.getElementById('shortcutsModal')?.classList.remove('active');
            document.getElementById('focusModeOverlay')?.classList.remove('active');
            closeLinkModal();
            closeFolderModal();
            closeNoteModal();
            closeColumnModal();
            closeEditNoteModal();
            closeConfirmModal();
            closeMoodReportModal();
            
            focusModeActive = false;
        }

        // ===== WATER REMINDER =====
        let waterReminderInterval = null;
        const WATER_REMINDER_INTERVAL = 60 * 60 * 1000; // 1 hour

        function initWaterReminder() {
            // Check if reminders are enabled
            const remindersEnabled = localStorage.getItem('waterRemindersEnabled') !== 'false';
            
            if (remindersEnabled) {
                startWaterReminder();
            }
        }

        function startWaterReminder() {
            // Clear existing interval
            if (waterReminderInterval) {
                clearInterval(waterReminderInterval);
            }
            
            // Set reminder every hour
            waterReminderInterval = setInterval(() => {
                // Only show if not at goal yet
                if (waterCount < waterGoal) {
                    showWaterReminder();
                }
            }, WATER_REMINDER_INTERVAL);
            
            // Also request notification permission
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function showWaterReminder() {
            const popup = document.getElementById('waterReminderPopup');
            popup.classList.add('show');
            
            // Play sound
            playWaterSound();
            
            // Send browser notification
            if (Notification.permission === 'granted') {
                new Notification('ðŸ’§ Hora de beber Ã¡gua!', {
                    body: `VocÃª bebeu ${waterCount}/${waterGoal} copos hoje.`,
                    icon: 'ðŸ’§',
                    tag: 'water-reminder'
                });
            }
            
            // Auto-hide after 10 seconds
            setTimeout(hideWaterReminder, 10000);
        }

        function hideWaterReminder() {
            document.getElementById('waterReminderPopup').classList.remove('show');
        }

        function playWaterSound() {
            try {
                const audio = new AudioContext();
                const oscillator = audio.createOscillator();
                const gain = audio.createGain();
                oscillator.connect(gain);
                gain.connect(audio.destination);
                oscillator.frequency.value = 600;
                oscillator.type = 'sine';
                gain.gain.setValueAtTime(0.3, audio.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audio.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audio.currentTime + 0.5);
            } catch (e) {}
        }

        // ===== IMPROVED POMODORO SOUND =====
        function playPomodoroEndSound() {
            try {
                const audio = new AudioContext();
                const frequencies = [523, 659, 784, 1047]; // C5, E5, G5, C6 (victory chord)
                
                frequencies.forEach((freq, i) => {
                    const oscillator = audio.createOscillator();
                    const gain = audio.createGain();
                    oscillator.connect(gain);
                    gain.connect(audio.destination);
                    oscillator.frequency.value = freq;
                    oscillator.type = 'sine';
                    gain.gain.setValueAtTime(0, audio.currentTime + (i * 0.1));
                    gain.gain.linearRampToValueAtTime(0.3, audio.currentTime + (i * 0.1) + 0.1);
                    gain.gain.exponentialRampToValueAtTime(0.01, audio.currentTime + (i * 0.1) + 1);
                    oscillator.start(audio.currentTime + (i * 0.1));
                    oscillator.stop(audio.currentTime + (i * 0.1) + 1);
                });
            } catch (e) {}
        }

        // ===== TASK DUE DATE NOTIFICATIONS =====
        function checkDueDateNotifications() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            notes.forEach(note => {
                if (!note.dueDate || note.completed) return;
                
                const due = new Date(note.dueDate + 'T00:00:00');
                const diffDays = Math.ceil((due - today) / (1000 * 60 * 60 * 24));
                
                // Notify for tasks due today or tomorrow
                if (diffDays === 0) {
                    const notified = localStorage.getItem(`notified_${note.id}_today`);
                    if (!notified) {
                        showToast('warning', 'Tarefa vence HOJE!', note.title);
                        localStorage.setItem(`notified_${note.id}_today`, 'true');
                        
                        if (Notification.permission === 'granted') {
                            new Notification('âš ï¸ Tarefa vence HOJE!', {
                                body: note.title,
                                tag: `task-${note.id}`
                            });
                        }
                    }
                } else if (diffDays === 1) {
                    const notified = localStorage.getItem(`notified_${note.id}_tomorrow`);
                    if (!notified) {
                        showToast('info', 'Tarefa vence amanhÃ£', note.title);
                        localStorage.setItem(`notified_${note.id}_tomorrow`, 'true');
                    }
                } else if (diffDays < 0) {
                    const notified = localStorage.getItem(`notified_${note.id}_overdue`);
                    if (!notified) {
                        showToast('error', 'Tarefa ATRASADA!', note.title);
                        localStorage.setItem(`notified_${note.id}_overdue`, 'true');
                    }
                }
            });
        }

        // ===== FORECAST (5 DAYS) =====
        let forecastCache = JSON.parse(localStorage.getItem('forecastCache')) || null;

        function openForecastModal() {
            document.getElementById('forecastModal').classList.remove('hidden');
            document.getElementById('forecastModal').classList.add('flex');
            fetchForecast();
        }

        function closeForecastModal() {
            document.getElementById('forecastModal').classList.add('hidden');
            document.getElementById('forecastModal').classList.remove('flex');
        }

        async function fetchForecast() {
            const loadingEl = document.getElementById('forecastLoading');
            const errorEl = document.getElementById('forecastError');
            const contentEl = document.getElementById('forecastContent');
            
            loadingEl.classList.remove('hidden');
            errorEl.classList.add('hidden');
            contentEl.classList.add('hidden');
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000);
                
                const response = await fetch(
                    'https://api.open-meteo.com/v1/forecast?latitude=-20.2&longitude=-44.4&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max,sunrise,sunset&timezone=America/Sao_Paulo&forecast_days=6',
                    { signal: controller.signal }
                );
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                
                if (!data.daily) {
                    throw new Error('Dados invÃ¡lidos');
                }
                
                // Save to cache
                forecastCache = {
                    data: data.daily,
                    timestamp: Date.now()
                };
                localStorage.setItem('forecastCache', JSON.stringify(forecastCache));
                
                renderForecast(data.daily);
                
                loadingEl.classList.add('hidden');
                errorEl.classList.add('hidden');
                contentEl.classList.remove('hidden');
                
            } catch (error) {
                console.error('[PrevisÃ£o] Erro:', error.message);
                
                // Try cache
                if (forecastCache && forecastCache.data) {
                    renderForecast(forecastCache.data);
                    loadingEl.classList.add('hidden');
                    errorEl.classList.add('hidden');
                    contentEl.classList.remove('hidden');
                    showToast('warning', 'Usando cache', 'Mostrando previsÃ£o salva anteriormente');
                } else {
                    loadingEl.classList.add('hidden');
                    errorEl.classList.remove('hidden');
                    contentEl.classList.add('hidden');
                }
            }
        }

        function renderForecast(daily) {
            const daysOfWeek = ['Domingo', 'Segunda', 'TerÃ§a', 'Quarta', 'Quinta', 'Sexta', 'SÃ¡bado'];
            const today = new Date();
            
            // Today summary
            document.getElementById('forecastTodayTemp').textContent = `${Math.round(daily.temperature_2m_max[0])}Â°C`;
            document.getElementById('forecastTodayMinMax').textContent = `Min: ${Math.round(daily.temperature_2m_min[0])}Â°C`;
            document.getElementById('forecastTodayDesc').textContent = getWeatherDescription(daily.weather_code[0]);
            
            // Sunrise/Sunset
            if (daily.sunrise && daily.sunrise[0]) {
                const sunrise = new Date(daily.sunrise[0]);
                document.getElementById('forecastSunrise').textContent = sunrise.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            }
            if (daily.sunset && daily.sunset[0]) {
                const sunset = new Date(daily.sunset[0]);
                document.getElementById('forecastSunset').textContent = sunset.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            }
            
            // 5 days forecast (skip today, show next 5)
            const forecastDays = document.getElementById('forecastDays');
            let html = '';
            
            for (let i = 1; i <= 5 && i < daily.time.length; i++) {
                const date = new Date(daily.time[i] + 'T12:00:00');
                const dayName = i === 1 ? 'AmanhÃ£' : daysOfWeek[date.getDay()];
                const weatherCode = daily.weather_code[i];
                const maxTemp = Math.round(daily.temperature_2m_max[i]);
                const minTemp = Math.round(daily.temperature_2m_min[i]);
                const rainProb = daily.precipitation_probability_max ? daily.precipitation_probability_max[i] : 0;
                const emoji = getWeatherEmoji(weatherCode);
                const desc = getWeatherDescription(weatherCode);
                
                html += `
                    <div class="forecast-day">
                        <div class="forecast-day-name">${dayName}</div>
                        <div class="forecast-day-icon">${emoji}</div>
                        <div class="forecast-day-desc">${desc}</div>
                        ${rainProb > 0 ? `
                            <div class="forecast-rain">
                                <i class="fas fa-tint"></i>
                                <span>${rainProb}%</span>
                            </div>
                        ` : '<div class="forecast-rain"></div>'}
                        <div class="forecast-day-temps">
                            <span class="forecast-temp-max">${maxTemp}Â°</span>
                            <span class="forecast-temp-min">${minTemp}Â°</span>
                        </div>
                    </div>
                `;
            }
            
            forecastDays.innerHTML = html;
            
            // Last update
            document.getElementById('forecastLastUpdate').textContent = 
                `Atualizado: ${new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
        }

        function getWeatherEmoji(code) {
            if (code === 0) return 'â˜€ï¸';
            if (code <= 3) return 'â›…';
            if (code <= 48) return 'â˜ï¸';
            if (code <= 57) return 'ðŸŒ«ï¸';
            if (code <= 67) return 'ðŸŒ§ï¸';
            if (code <= 77) return 'ðŸŒ¨ï¸';
            if (code <= 82) return 'ðŸŒ§ï¸';
            if (code <= 86) return 'ðŸŒ¨ï¸';
            if (code <= 99) return 'â›ˆï¸';
            return 'â˜€ï¸';
        }

        function getWeatherDescription(code) {
            if (code === 0) return 'CÃ©u limpo';
            if (code <= 3) return 'Parcialmente nublado';
            if (code <= 48) return 'Nublado';
            if (code <= 49) return 'Neblina';
            if (code <= 55) return 'Chuvisco';
            if (code <= 57) return 'Chuvisco gelado';
            if (code <= 65) return 'Chuva';
            if (code <= 67) return 'Chuva gelada';
            if (code <= 75) return 'Neve';
            if (code <= 77) return 'Granizo';
            if (code <= 82) return 'Pancadas de chuva';
            if (code <= 86) return 'Neve forte';
            if (code <= 99) return 'Tempestade';
            return 'CÃ©u limpo';
        }

        // ===== PWA & SERVICE WORKER =====
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker registrado'))
                    .catch(err => console.log('Erro ao registrar SW:', err));
            });
        }

        // ===== INITIALIZATION =====
        function init() {
            // Load user settings first
            loadSettings();
            
            showSplashScreen();
            initParallax();
            
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }

            updateClock();
            setInterval(updateClock, 1000);

            // Weather: Show cache immediately if available, then fetch fresh data
            initWeather();
            setInterval(fetchWeather, 600000); // Update every 10 minutes
            setInterval(updateBackground, 60000);

            showRandomQuote();
            setInterval(showRandomQuote, 60000);

            renderLinks();
            migrateNotes();
            renderKanban();
            updatePomodoroDisplay();

            document.getElementById('pomodoroCount').textContent = `SessÃµes: ${pomodoroSessions}`;

            // Water Tracker
            checkWaterDate();
            updateWaterDisplay();

            // Mood Tracker
            initMoodTracker();
            
            // Keyboard Shortcuts
            initKeyboardShortcuts();
            
            // Water Reminders
            initWaterReminder();
            
            // Check due date notifications
            checkDueDateNotifications();
            setInterval(checkDueDateNotifications, 60000 * 30); // Check every 30 minutes
        }

        init();
    </script>
</body>
</html>
